
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <link rel="stylesheet" href="bootstrap.min.css">
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;
        line-height: 1.5;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>N-step Bootstrapping For Advantage Actor Critic</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><blockquote>
<p>by Xiaoxiao Wen, Yijie Zhang, Zhenyu Gao, Weitao Luo</p>
</blockquote>
<h2>1. Introduction and Motivation</h2>
<p>In this project, we study n-step bootstrapping in actor critic methods <a href="https://www.cambridge.org/core/journals/robotica/article/robot-learning-edited-by-jonathan-h-connell-and-sridhar-mahadevan-kluwer-boston-19931997-xii240-pp-isbn-0792393651-hardback-21800-guilders-12000-8995/737FD21CA908246DF17779E9C20B6DF6">[1]</a>, more specific, we would like to investigate, when using n-step bootstrapping for advantage actor critic (A2C), how different values of <span class="MathJax" id="MathJax-Element-175-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2868" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2869"><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">n</script> will affect the model performances, measured by different metrics, for example, convergence speed and stability (variance).</p>
<h3>1.1 N-step bootstrapping</h3>
<p>N-step bootstrapping <a href="https://www.cambridge.org/core/journals/robotica/article/robot-learning-edited-by-jonathan-h-connell-and-sridhar-mahadevan-kluwer-boston-19931997-xii240-pp-isbn-0792393651-hardback-21800-guilders-12000-8995/737FD21CA908246DF17779E9C20B6DF6">[1]</a>, or TD(N) is a very important technique in Reinforcement Learning that performs update based on intermediate number of rewards.</p>
<p>In this view, N-step bootstrapping unifies and generalizes the Monte Carlo (MC) methods and Temporal Difference (TD) methods. From one extreme, when <span class="MathJax" id="MathJax-Element-176-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2871" style="width: 2.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.59em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2872"><span class="mi" id="MathJax-Span-2873" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-2874" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-2875" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-176">N=1</script>, it is equivalent to TD(1), from another extreme, when <span class="MathJax" id="MathJax-Element-177-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2876" style="width: 3.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2877"><span class="mi" id="MathJax-Span-2878" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-2879" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-2880" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∞</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-177">N=\infty</script>, i.e., taking as many steps as possible until the end of the episode, it becomes MC.</p>
<p>As a result, N-step bootstrapping also combines the advantages of Monte Carlo	and	1-step TD. Compared to 1-step TD, n-step bootstrapping will	converge faster because it bootstraps with more real information and it is freed from the “tyranny of the time step”. Compared to MC, the updates do not have to wait until the end of the episode and it is also more efficient and less variants. In general, when facing different problems / situations, with a suitable N, we could often achieve faster and more stable learning.</p>
<div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191014053755194.png" width="300" height="300" alt="N-steps" align="center"></div>
<center>Figure1: Diagrams for n-step bootstrapping.</center>
<h3>1.2 Advantage Actor Critic (A2C)</h3>
<p>Actor-Critic algorithms are a power families of learning algorithms within the policy-based framework in Reinforcement Learning. It composes of actor, the policy that makes decision and critic, the value function that evaluates if it is a good decision. With the assistant from critic, the actor can usually achieves better performance, such as by reducing gradient variance in vanilla policy gradients.</p>
<p>From the <a href="https://arxiv.org/pdf/1506.02438v3.pdf">GAE paper</a> <a href="https://arxiv.org/abs/1506.02438">[2]</a>, John Schulman has unified the framework for advantage estimation, between all the GAE variants, we picked A2C considering the amazing performance of A3C and it is a simplified version of A3C with equivalent performance.</p>
<p>In the following sections, we first explain the method of n-step Bootstrapping for A2C, which also includes 1-step and Monte-Carlo as mentioned above, and then briefly introduce the neural network architecture. Subsequently, we introduce the conducted experiments with their corresponding settings and finally we discuss the results and draw some conclusions.</p>
<h2>2. Methods</h2>
<h3>2.1 n-step Bootstrapping for A2C</h3>
<p>n-step A2C is an online algorithm that uses roll-outs of size n + 1 of the current policy to perform a policy improvement step. In order to train the policy-head, an approximation of the policy-gradient is computed for each state of the roll-out <span class="MathJax" id="MathJax-Element-178-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2881" style="width: 15.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.302em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.123em, 1000em, 2.775em, -0.368em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2882"><span class="msubsup" id="MathJax-Span-2883"><span style="display: inline-block; position: relative; width: 14.264em; height: 0px;"><span style="position: absolute; clip: rect(1.95em, 1000em, 3.518em, -0.368em); top: -2.984em; left: 0em;"><span class="mrow" id="MathJax-Span-2884"><span class="mo" id="MathJax-Span-2885" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-2886"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2887" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-2888"><span class="mrow" id="MathJax-Span-2889"><span class="mi" id="MathJax-Span-2890" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2891" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-2892" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2893" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2894" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2895" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-2896"><span class="mrow" id="MathJax-Span-2897"><span class="mi" id="MathJax-Span-2898" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2899" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-2900" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2901" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="mi" id="MathJax-Span-2902" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mrow" id="MathJax-Span-2903" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2904" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="mo" id="MathJax-Span-2905" style="font-family: STIXGeneral-Regular;">⋅</span><span class="texatom" id="MathJax-Span-2906"><span class="mrow" id="MathJax-Span-2907"><span class="mo" id="MathJax-Span-2908" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2909"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2910" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-2911"><span class="mrow" id="MathJax-Span-2912"><span class="mi" id="MathJax-Span-2913" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2914" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-2915" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2916" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-2917" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2918" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2919"><span class="mrow" id="MathJax-Span-2920"><span class="mi" id="MathJax-Span-2921" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2922" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-2923" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-2924" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.46em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2925" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom" id="MathJax-Span-2926"><span class="mrow" id="MathJax-Span-2927"><span class="mi" id="MathJax-Span-2928" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2929" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-2930" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2931" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.484em, -0.497em); top: -2.901em; left: 13.063em;"><span class="texatom" id="MathJax-Span-2932"><span class="mrow" id="MathJax-Span-2933"><span class="mi" id="MathJax-Span-2934" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.487em, -0.472em); top: -1.908em; left: 13.063em;"><span class="texatom" id="MathJax-Span-2935"><span class="mrow" id="MathJax-Span-2936"><span class="mi" id="MathJax-Span-2937" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2938" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2939" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.584em; vertical-align: -0.518em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-178">\left(x_{t+i}, a_{t+i} \sim \pi\left(\cdot | x_{t+i} ; \theta_{\pi}\right), r_{t+i}\right)_{i=0}^{n}</script>, expressed as<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-179-Frame" style=""><nobr><span class="math" id="MathJax-Span-2940" style="width: 21.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.088em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.15em, 1000em, 4.332em, -0.444em); top: -3.491em; left: 0em;"><span class="mrow" id="MathJax-Span-2941"><span class="msubsup" id="MathJax-Span-2942"><span style="display: inline-block; position: relative; width: 1.582em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2943" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.788em;"><span class="texatom" id="MathJax-Span-2944"><span class="mrow" id="MathJax-Span-2945"><span class="msubsup" id="MathJax-Span-2946"><span style="display: inline-block; position: relative; width: 0.719em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2947" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-2948"><span class="mrow" id="MathJax-Span-2949"><span class="mi" id="MathJax-Span-2950" style="font-size: 50%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-2951" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mrow" id="MathJax-Span-2952" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2953" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="mi" id="MathJax-Span-2954" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mrow" id="MathJax-Span-2955" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2956" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-2957"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2958" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-2959"><span class="mrow" id="MathJax-Span-2960"><span class="mi" id="MathJax-Span-2961" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2962" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-2963" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2964"><span class="mrow" id="MathJax-Span-2965"><span class="mo" id="MathJax-Span-2966" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2967"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2968" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-2969"><span class="mrow" id="MathJax-Span-2970"><span class="mi" id="MathJax-Span-2971" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2972" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-2973" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2974" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-2975" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2976" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-2977"><span class="mrow" id="MathJax-Span-2978"><span class="mi" id="MathJax-Span-2979" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2980" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-2981" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mrow" id="MathJax-Span-2982" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2983" style="vertical-align: -0.393em; padding-left: 0.188em;"><span style="font-family: STIXSizeTwoSym;">[</span></span><span class="msubsup" id="MathJax-Span-2984"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-2985"><span class="mrow" id="MathJax-Span-2986"><span class="munderover" id="MathJax-Span-2987"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2988" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2989" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-2990"><span class="mrow" id="MathJax-Span-2991"><span class="mi" id="MathJax-Span-2992" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2993" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-2994" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mrow" id="MathJax-Span-2995" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2996" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-2997"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2998" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-2999"><span class="mrow" id="MathJax-Span-3000"><span class="mi" id="MathJax-Span-3001" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3002" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3003" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3004" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-3005" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3006" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3007"><span class="mrow" id="MathJax-Span-3008"><span class="mi" id="MathJax-Span-3009" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3010" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-3011" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.491em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.173em; vertical-align: -0.809em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-179"> \nabla_{\theta_{\pi}} \log \left(\pi\left(a_{t+i} | x_{t+i} ; \theta_{\pi}\right)\right)\left[\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right] </script><br>
where <span class="MathJax" id="MathJax-Element-180-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3012" style="width: 1.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.053em, 1000em, 2.59em, -0.682em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-3013"><span class="msubsup" id="MathJax-Span-3014"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-3015"><span class="mrow" id="MathJax-Span-3016"><span class="munderover" id="MathJax-Span-3017"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3018" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3019" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-3020"><span class="mrow" id="MathJax-Span-3021"><span class="mi" id="MathJax-Span-3022" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.456em; vertical-align: -0.312em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-180">\hat{Q}_{i}</script> is an estimation of the return <span class="MathJax" id="MathJax-Element-181-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3023" style="width: 17.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.822em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.842em, 1000em, 3.596em, -0.682em); top: -2.984em; left: 0em;"><span class="mrow" id="MathJax-Span-3024"><span class="msubsup" id="MathJax-Span-3025"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-3026"><span class="mrow" id="MathJax-Span-3027"><span class="munderover" id="MathJax-Span-3028"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3029" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3030" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-3031"><span class="mrow" id="MathJax-Span-3032"><span class="mi" id="MathJax-Span-3033" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3034" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-3035" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-3036" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.484em, -0.497em); top: -2.797em; left: 0.957em;"><span class="texatom" id="MathJax-Span-3037"><span class="mrow" id="MathJax-Span-3038"><span class="mi" id="MathJax-Span-3039" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3040" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-3041" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.624em, -0.594em); top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-3042"><span class="mrow" id="MathJax-Span-3043"><span class="mi" id="MathJax-Span-3044" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3045" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-3046" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3047" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.541em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3048" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.509em;"><span class="texatom" id="MathJax-Span-3049"><span class="mrow" id="MathJax-Span-3050"><span class="mi" id="MathJax-Span-3051" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3052" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-3053" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3054"><span style="display: inline-block; position: relative; width: 1.46em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3055" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom" id="MathJax-Span-3056"><span class="mrow" id="MathJax-Span-3057"><span class="mi" id="MathJax-Span-3058" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3059" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3060" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3061" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3062" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.71em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3063" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.509em;"><span class="texatom" id="MathJax-Span-3064"><span class="mrow" id="MathJax-Span-3065"><span class="mi" id="MathJax-Span-3066" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3067" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-3068" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3069" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mrow" id="MathJax-Span-3070" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3071" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-3072"><span style="display: inline-block; position: relative; width: 1.705em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3073" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-3074"><span class="mrow" id="MathJax-Span-3075"><span class="mi" id="MathJax-Span-3076" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3077" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3078" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3079" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-3080" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3081" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3082"><span class="mrow" id="MathJax-Span-3083"><span class="mi" id="MathJax-Span-3084" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3085" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.697em; vertical-align: -0.554em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-181">\hat{Q}_{i}=\sum_{j=i}^{n-1} \gamma^{j-i} r_{t+j}+\gamma^{n-i} V\left(x_{t+n} ; \theta_{V}\right)</script>. The gradients <span class="MathJax" id="MathJax-Element-182-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3086" style="width: 2.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.711em, 1000em, 2.91em, -0.631em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3087"><span class="mi" id="MathJax-Span-3088" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3089" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-3090" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">i</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.081em; vertical-align: -0.292em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-182">j=i</script><br>
are then added to obtain the cumulative gradient of the roll-out as<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-183-Frame" style=""><nobr><span class="math" id="MathJax-Span-3091" style="width: 22.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.664em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.71em, 1000em, 4.92em, -0.417em); top: -3.491em; left: 0em;"><span class="mrow" id="MathJax-Span-3092"><span class="munderover" id="MathJax-Span-3093"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-3094" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-3095"><span class="mrow" id="MathJax-Span-3096"><span class="mi" id="MathJax-Span-3097" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3098" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3099" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.497em); top: -3.509em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3100"><span class="mrow" id="MathJax-Span-3101"><span class="mi" id="MathJax-Span-3102" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3103" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.582em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3104" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.788em;"><span class="texatom" id="MathJax-Span-3105"><span class="mrow" id="MathJax-Span-3106"><span class="msubsup" id="MathJax-Span-3107"><span style="display: inline-block; position: relative; width: 0.719em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3108" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-3109"><span class="mrow" id="MathJax-Span-3110"><span class="mi" id="MathJax-Span-3111" style="font-size: 50%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-3112" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mrow" id="MathJax-Span-3113" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3114" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="mi" id="MathJax-Span-3115" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mrow" id="MathJax-Span-3116" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3117" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-3118"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3119" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-3120"><span class="mrow" id="MathJax-Span-3121"><span class="mi" id="MathJax-Span-3122" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3123" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3124" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3125"><span class="mrow" id="MathJax-Span-3126"><span class="mo" id="MathJax-Span-3127" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3128"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3129" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-3130"><span class="mrow" id="MathJax-Span-3131"><span class="mi" id="MathJax-Span-3132" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3133" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3134" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3135" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-3136" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3137" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3138"><span class="mrow" id="MathJax-Span-3139"><span class="mi" id="MathJax-Span-3140" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3141" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-3142" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mrow" id="MathJax-Span-3143" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3144" style="vertical-align: -0.393em; padding-left: 0.188em;"><span style="font-family: STIXSizeTwoSym;">[</span></span><span class="msubsup" id="MathJax-Span-3145"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-3146"><span class="mrow" id="MathJax-Span-3147"><span class="munderover" id="MathJax-Span-3148"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3149" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3150" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-3151"><span class="mrow" id="MathJax-Span-3152"><span class="mi" id="MathJax-Span-3153" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3154" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-3155" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mrow" id="MathJax-Span-3156" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3157" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-3158"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3159" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-3160"><span class="mrow" id="MathJax-Span-3161"><span class="mi" id="MathJax-Span-3162" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3163" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3164" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3165" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-3166" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3167" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3168"><span class="mrow" id="MathJax-Span-3169"><span class="mi" id="MathJax-Span-3170" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3171" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-3172" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.491em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.313em; vertical-align: -1.461em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-183">     \sum_{i=0}^{n} \nabla_{\theta_{\pi}} \log \left(\pi\left(a_{t+i} | x_{t+i} ; \theta_{\pi}\right)\right)\left[\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right] </script><br>
A2C trains the value-head by minimising the error between the estimated return and the value as<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-184-Frame" style=""><nobr><span class="math" id="MathJax-Span-3173" style="width: 11.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.417em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.415em, 1000em, 3.625em, -0.417em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-3174"><span class="munderover" id="MathJax-Span-3175"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-3176" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-3177"><span class="mrow" id="MathJax-Span-3178"><span class="mi" id="MathJax-Span-3179" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3180" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3181" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.497em); top: -3.509em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3182"><span class="mrow" id="MathJax-Span-3183"><span class="mi" id="MathJax-Span-3184" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3185" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 8.859em; height: 0px;"><span style="position: absolute; clip: rect(2.15em, 1000em, 4.332em, -0.368em); top: -3.491em; left: 0em;"><span class="mrow" id="MathJax-Span-3186"><span class="mo" id="MathJax-Span-3187" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="msubsup" id="MathJax-Span-3188"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-3189"><span class="mrow" id="MathJax-Span-3190"><span class="munderover" id="MathJax-Span-3191"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3192" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3193" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-3194"><span class="mrow" id="MathJax-Span-3195"><span class="mi" id="MathJax-Span-3196" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3197" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-3198" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mrow" id="MathJax-Span-3199" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3200" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-3201"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3202" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-3203"><span class="mrow" id="MathJax-Span-3204"><span class="mi" id="MathJax-Span-3205" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3206" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3207" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3208" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-3209" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3210" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3211"><span class="mrow" id="MathJax-Span-3212"><span class="mi" id="MathJax-Span-3213" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3214" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-3215" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.491em;"></span></span><span style="position: absolute; top: -3.208em; left: 8.39em;"><span class="texatom" id="MathJax-Span-3216"><span class="mrow" id="MathJax-Span-3217"><span class="mn" id="MathJax-Span-3218" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.313em; vertical-align: -1.461em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-184">\sum_{i=0}^{n}\left(\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right)^{2}</script><p></p>
<p>Therefore, the network parameters <span class="MathJax" id="MathJax-Element-185-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3219" style="width: 3.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.435em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.95em, 1000em, 3.518em, -0.368em); top: -2.984em; left: 0em;"><span class="mrow" id="MathJax-Span-3220"><span class="mrow" id="MathJax-Span-3221"><span class="mo" id="MathJax-Span-3222" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-3223"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3224" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3225"><span class="mrow" id="MathJax-Span-3226"><span class="mi" id="MathJax-Span-3227" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3228" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3229" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3230" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3231"><span class="mrow" id="MathJax-Span-3232"><span class="mi" id="MathJax-Span-3233" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3234" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.49em; vertical-align: -0.468em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-185">\left(\theta_{\pi}, \theta_{V}\right)</script> are updated after each roll-out as follows:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-186-Frame" style=""><nobr><span class="math" id="MathJax-Span-3235" style="width: 29.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.914em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-1.32em, 1000em, 5.212em, -0.313em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-3236"><span class="mtable" id="MathJax-Span-3237" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 26.577em; height: 0px;"><span style="position: absolute; clip: rect(3.692em, 1000em, 10.223em, -0.48em); top: -7.207em; left: 0em;"><span style="display: inline-block; position: relative; width: 26.577em; height: 0px;"><span style="position: absolute; clip: rect(1.71em, 1000em, 4.92em, -0.48em); top: -5.226em; left: 0em;"><span class="mtd" id="MathJax-Span-3238"><span class="mrow" id="MathJax-Span-3239"><span class="texatom" id="MathJax-Span-3240"><span class="mrow" id="MathJax-Span-3241"><span class="msubsup" id="MathJax-Span-3242"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3243" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3244"><span class="mrow" id="MathJax-Span-3245"><span class="mi" id="MathJax-Span-3246" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3247" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">←</span><span class="msubsup" id="MathJax-Span-3248" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3249" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3250"><span class="mrow" id="MathJax-Span-3251"><span class="mi" id="MathJax-Span-3252" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3253" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3254" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3255" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-3256"><span class="mrow" id="MathJax-Span-3257"><span class="mi" id="MathJax-Span-3258" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3259" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-3260" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-3261"><span class="mrow" id="MathJax-Span-3262"><span class="mi" id="MathJax-Span-3263" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3264" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3265" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.497em); top: -3.509em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3266"><span class="mrow" id="MathJax-Span-3267"><span class="mi" id="MathJax-Span-3268" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3269" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.582em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3270" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.788em;"><span class="texatom" id="MathJax-Span-3271"><span class="mrow" id="MathJax-Span-3272"><span class="msubsup" id="MathJax-Span-3273"><span style="display: inline-block; position: relative; width: 0.719em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3274" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-3275"><span class="mrow" id="MathJax-Span-3276"><span class="mi" id="MathJax-Span-3277" style="font-size: 50%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-3278" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mrow" id="MathJax-Span-3279" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3280" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="mi" id="MathJax-Span-3281" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mrow" id="MathJax-Span-3282" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3283" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-3284"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3285" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-3286"><span class="mrow" id="MathJax-Span-3287"><span class="mi" id="MathJax-Span-3288" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3289" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3290" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3291"><span class="mrow" id="MathJax-Span-3292"><span class="mo" id="MathJax-Span-3293" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3294"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3295" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-3296"><span class="mrow" id="MathJax-Span-3297"><span class="mi" id="MathJax-Span-3298" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3299" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3300" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3301" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-3302" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3303" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3304"><span class="mrow" id="MathJax-Span-3305"><span class="mi" id="MathJax-Span-3306" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3307" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-3308" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mrow" id="MathJax-Span-3309" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3310" style="vertical-align: -0.393em; padding-left: 0.188em;"><span style="font-family: STIXSizeTwoSym;">[</span></span><span class="msubsup" id="MathJax-Span-3311"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-3312"><span class="mrow" id="MathJax-Span-3313"><span class="munderover" id="MathJax-Span-3314"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3315" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3316" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-3317"><span class="mrow" id="MathJax-Span-3318"><span class="mi" id="MathJax-Span-3319" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3320" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-3321" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mrow" id="MathJax-Span-3322" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3323" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-3324"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3325" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-3326"><span class="mrow" id="MathJax-Span-3327"><span class="mi" id="MathJax-Span-3328" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3329" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3330" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3331" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-3332" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3333" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3334"><span class="mrow" id="MathJax-Span-3335"><span class="mi" id="MathJax-Span-3336" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3337" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-3338" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">]</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.491em;"></span></span><span style="position: absolute; clip: rect(0.753em, 1000em, 3.963em, -0.48em); top: -0.947em; left: 0em;"><span class="mtd" id="MathJax-Span-3339"><span class="mrow" id="MathJax-Span-3340"><span class="texatom" id="MathJax-Span-3341"><span class="mrow" id="MathJax-Span-3342"><span class="msubsup" id="MathJax-Span-3343"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3344" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3345"><span class="mrow" id="MathJax-Span-3346"><span class="mi" id="MathJax-Span-3347" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3348" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">←</span><span class="msubsup" id="MathJax-Span-3349" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3350" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3351"><span class="mrow" id="MathJax-Span-3352"><span class="mi" id="MathJax-Span-3353" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3354" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-3355" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3356" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-3357"><span class="mrow" id="MathJax-Span-3358"><span class="mi" id="MathJax-Span-3359" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3360" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-3361" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-3362"><span class="mrow" id="MathJax-Span-3363"><span class="mi" id="MathJax-Span-3364" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3365" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3366" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.497em); top: -3.509em; left: 0.479em;"><span class="texatom" id="MathJax-Span-3367"><span class="mrow" id="MathJax-Span-3368"><span class="mi" id="MathJax-Span-3369" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3370" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.638em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3371" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.788em;"><span class="texatom" id="MathJax-Span-3372"><span class="mrow" id="MathJax-Span-3373"><span class="msubsup" id="MathJax-Span-3374"><span style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3375" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-3376"><span class="mrow" id="MathJax-Span-3377"><span class="mi" id="MathJax-Span-3378" style="font-size: 50%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3379"><span style="display: inline-block; position: relative; width: 8.577em; height: 0px;"><span style="position: absolute; clip: rect(2.15em, 1000em, 4.332em, -0.317em); top: -3.491em; left: 0em;"><span class="mrow" id="MathJax-Span-3380"><span class="mo" id="MathJax-Span-3381" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">[</span></span><span class="msubsup" id="MathJax-Span-3382"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-3383"><span class="mrow" id="MathJax-Span-3384"><span class="munderover" id="MathJax-Span-3385"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3386" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-3387" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-3388"><span class="mrow" id="MathJax-Span-3389"><span class="mi" id="MathJax-Span-3390" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3391" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-3392" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mrow" id="MathJax-Span-3393" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3394" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-3395"><span style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3396" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-3397"><span class="mrow" id="MathJax-Span-3398"><span class="mi" id="MathJax-Span-3399" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3400" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-3401" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3402" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-3403" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3404" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-3405"><span class="mrow" id="MathJax-Span-3406"><span class="mi" id="MathJax-Span-3407" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3408" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-3409" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.491em;"></span></span><span style="position: absolute; top: -3.208em; left: 8.108em;"><span class="texatom" id="MathJax-Span-3410"><span class="mrow" id="MathJax-Span-3411"><span class="mn" id="MathJax-Span-3412" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.207em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 7em; vertical-align: -3.222em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-186">     \begin{array}{l}{\theta_{\pi} \leftarrow \theta_{\pi}+\alpha_{\pi} \sum_{i=0}^{n} \nabla_{\theta_{\pi}} \log \left(\pi\left(a_{t+i} | x_{t+i} ; \theta_{\pi}\right)\right)\left[\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right]} \\ {\theta_{V} \leftarrow \theta_{V}-\alpha_{V} \sum_{i=0}^{n} \nabla_{\theta_{V}}\left[\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right]^{2}}\end{array} </script><br>
where <span class="MathJax" id="MathJax-Element-187-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3413" style="width: 3.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.322em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3414"><span class="mrow" id="MathJax-Span-3415"><span class="mo" id="MathJax-Span-3416" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3417"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3418" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-3419"><span class="mrow" id="MathJax-Span-3420"><span class="mi" id="MathJax-Span-3421" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3422" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3423" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3424" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-3425"><span class="mrow" id="MathJax-Span-3426"><span class="mi" id="MathJax-Span-3427" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3428" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-187">\left(\alpha_{\pi}, \alpha_{V}\right)</script> are learning rates are policy-head and value-head.<p></p>
<h3>2.2 Network Architecture</h3>
<p>Similar to the <a href="https://github.com/pytorch/examples/blob/master/reinforcement_learning/actor_critic.py">Actor-critic example from pytorch</a> and <a href="https://github.com/floodsung/a2c_cartpole_pytorch/blob/master/a2c_cartpole.py">Floodsung's repo</a>, we use simple and straightforward networks for both the actor function and the critic function.</p>
<h4>2.2.1 Actor Network</h4>
<p>The actor network consists of two fully connected layers which extract potential features from the input observations. To introduce non-linearity, the ReLU activations <a href="https://arxiv.org/abs/1803.08375">[3]</a> are used upon these two layers. Then, the output is another fully connected layer which summarizes into one-dimensional continuous value.</p>
<h4>2.2.2 Critic Network</h4>
<p>The critic network shares the similar architecture with the actor network with the fully connected layers and the ReLU activations. However, depending on the environment, discrete or continuous action space, the final output is distinct. For discrete action space, the <span class="MathJax" id="MathJax-Element-188-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3429" style="width: 1.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3430"><span class="mi" id="MathJax-Span-3431" style="font-family: STIXGeneral-Regular;">log</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.125em; vertical-align: -0.304em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-188">\log</script> Softmax is used to compute the distribution of the available discrete actions. For continuous action space, we instead output a mean and a standard deviation for the univariate Gaussian distribution, which we later use to sample continuous actions.</p>
<h2>3. Experiments</h2>
<p>All our code can be see in Github.</p>
<blockquote>
<p><a href="https://github.com/vincentwen1995/rl-reprod">Reinforcement Learning Reproducibility Lab</a></p>
</blockquote>
<h3>3.1 Environments</h3>
<p>For this project, our main goal is to compare the performance of the n-step bootstrapping variation of A2C with its Monte-Carlo and 1-step variations in a straightforward manner. Therefore, we do not seek to deliver an ultimate agent that can solve some complicated fancy games or park your car.</p>
<p>The experiments are designed with classical control problems, i.e. InvertedPendulum, CartPole, Acrobot, MountainCar etc. For the sake of convenience in terms of implementation, we use the off-the-shelf environments provided by <a href="https://gym.openai.com">OpenAI's  Gym library</a>. Under the category <em>Classical Control</em>, we picked out two discrete environments: <strong>CartPole-v0</strong> and <strong>Acrobot-v1</strong>.</p>
<p>The <strong>CartPole-v0</strong> environment contains a pole attached by a an un-actuated joint to a cart in a 2D plane. The cart moves left/right along a frictionless track. The goal is to balance the poll staying upright by indirectly influencing the velocity of the cart. There are 4 continuous observations of this environment, consisting of the <em>Cart Position</em>, <em>Cart Velocity</em>, <em>Pole Angle</em> and <em>Pole Velocity At Tip</em> within their corresponding range. The available actions consist of two discrete actions <em>Push Left</em> and <em>Push Right</em>, which increases the <em>Cart Velocity</em> by an unknown amount in the corresponding direction. At starting state, all the observations are initialized with a small uniform random value. The termination of each episode is defined by the pole angle's or the cart position's exceeding a certain threshold, or when the episode length exceeds 200 steps. The reward is 1 for every step taken in each episode, indicating the durability of the stabilization by the agent. You can see it in the Figure 2 (From "<a href="https://dzone.com/articles/using-bayesian-optimization-for-reinforcement-lear">Using Bayesian Optimization for Reinforcement Learning</a>").</p>
<div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191018234318832.gif" width="300" height="300" alt="N-steps" align="center"></div>
<center>Figure2: Cartpole.</center>
<p>The <strong>Pendulum-v0</strong> environment contains a pendulum, or in other words, a link connected to an actuated joint in a 2D plane. The pendulum can spin frictionlessly. The goal is to keep the pendulum upright by applying a continuous torque on the joint. There are 3 continuous observations of this environment, consisting of the <span class="MathJax" id="MathJax-Element-189-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3432" style="width: 1.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3433"><span class="mi" id="MathJax-Span-3434" style="font-family: STIXGeneral-Regular;">cos</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.647em; vertical-align: -0.074em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-189">\cos</script> and <span class="MathJax" id="MathJax-Element-190-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3435" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.239em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.713em, -0.456em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3436"><span class="mi" id="MathJax-Span-3437" style="font-family: STIXGeneral-Regular;">sin</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.894em; vertical-align: -0.074em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-190">\sin</script> values of the <em>Pendulum Angle</em> respectively and the <em>Angular Velocity</em> of the pendulum. The available action is a continuous action <em>Apply Torque</em>. At starting state, the pendulum is initiated at a random angle and a random angular velocity. The environment is terminated when the episode length exceeds  200 steps. The reward is computed according to a function of the angle, angular velocity and the torque, which ranges from <span class="MathJax" id="MathJax-Element-191-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3438" style="width: 1.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.681em, 1000em, 2.717em, -0.443em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3439"><span class="mo" id="MathJax-Span-3440" style="font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-3441" style="font-family: STIXGeneral-Regular;">16</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.9em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-191">-16</script> to <span class="MathJax" id="MathJax-Element-192-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3442" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.483em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3443"><span class="mn" id="MathJax-Span-3444" style="font-family: STIXGeneral-Regular;">0</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-192">0</script>, so the goal can be explained as to remain at zero angle, with the least angular velocity and the least torque, indicating the speed and the quality of the stabilization by the agent. You can see it in Figure 3 (From "<a href="https://towardsdatascience.com/solving-reinforcement-learning-classic-control-problems-openaigym-1b50413265dd">Solving Reinforcement Learning Classic Control Problems | OpenAIGym</a>").</p>
<div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191018234847731.gif" width="300" height="300" alt="N-steps" align="center"></div>
<center>Figure3: Pendulum</center>
<h2>3.2 Settings</h2>
<p>The hyperparameter settings are trivial for the actor and critic networks. In the aforementioned fully connected layers, we use a hidden size of 64 nodes, which we found empirically. Furthermore, the discount rate <span class="MathJax" id="MathJax-Element-193-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3445" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3446"><span class="mi" id="MathJax-Span-3447" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.837em; vertical-align: -0.291em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-193">\gamma</script> is set to 0.99.</p>
<p>In order to evaluate how different <span class="MathJax" id="MathJax-Element-175-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2868" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2869"><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">n</script> will affect the performances, we need to conduct experiments and investigate the model behaviors in different learning stages.</p>
<p>To make the comparison objective and accurate, instead of fixing the number of training episodes, we fix the total number of <span class="MathJax" id="MathJax-Element-194-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3448" style="width: 2.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3449"><span class="mn" id="MathJax-Span-3450" style="font-family: STIXGeneral-Regular;">10000</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-194">10000</script> training steps. More specific, for training, each agent will interact and learn in the environments for <span class="MathJax" id="MathJax-Element-195-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3451" style="width: 1.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3452"><span class="mn" id="MathJax-Span-3453" style="font-family: STIXGeneral-Regular;">100</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-195">100</script> steps according to their updating schemes strictly (n-steps, TD or MC).</p>
<p>For example, if in a training cycle, the MC agent starts in time-step 14 and after 86 steps (totally 100 steps) the episode still continues, the MC agent will not receive any updates. Then, for evaluation, we run the agent in the exact environments as in training for 50 episodes and store the total rewards per episode. With this data, the learning behavior and model performance of each agent can be represented and compared scientifically in terms of mean and standard deviation per evaluation step and, furthermore, the mean and variance could be used to show the effectiveness and stability of learning accordingly.</p>
<p>To fully cover MC, TD and n-step bootstrapping, we chose and tested 6 different <span class="MathJax" id="MathJax-Element-175-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2868" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2869"><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">n</script> given the different termination conditions of two environments, which ranges from 1-step to max-step (or equivalently Monte Carlo). Finally, to decrease the effect of randomness, three different random seeds are tested and the experiment settings are shown in Table 1.</p>
<ul>
<li>Training: each agent will gain experience in the environment for every <span class="MathJax" id="MathJax-Element-195-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3451" style="width: 1.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3452"><span class="mn" id="MathJax-Span-3453" style="font-family: STIXGeneral-Regular;">100</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-195">100</script> steps and learn (or update their networks) according to their schemes.</li>
<li>Evaluation: after very  <span class="MathJax" id="MathJax-Element-195-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3451" style="width: 1.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3452"><span class="mn" id="MathJax-Span-3453" style="font-family: STIXGeneral-Regular;">100</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-195">100</script> training steps, each agents will be tested in the same environments and play for <span class="MathJax" id="MathJax-Element-196-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3454" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.677em, 1000em, 2.717em, -0.476em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3455"><span class="mn" id="MathJax-Span-3456" style="font-family: STIXGeneral-Regular;">50</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.904em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-196">50</script> episodes. There will be no learning in this stage and the rewards will be stored.</li>
</ul>
<center>Table1: Hyperparameter settings of the experiments.</center>
<table>
<thead>
<tr>
<th>Environment</th>
<th>Train Steps</th>
<th>Eval Interval</th>
<th>Eval steps</th>
<th>Random Seeds</th>
<th>Steps Roll-out</th>
</tr>
</thead>
<tbody>
<tr>
<td>CartPole-v0</td>
<td>10000</td>
<td>100</td>
<td>50</td>
<td>[42, 36, 15]</td>
<td>[1, 10, 40, 80, 150, 200]</td>
</tr>
<tr>
<td>Pendulum-v0</td>
<td>10000</td>
<td>100</td>
<td>50</td>
<td>[42, 36, 15]</td>
<td>[1, 10, 40, 80, 150, 200]</td>
</tr>
</tbody>
</table>
<h2>4. Results</h2>
<p>The results are shown in Figure 4 - Figure 7, where for better visualization and distinction, only two n-step variations are selected.</p>
<h3>4.1 CartPole</h3>
<p>As shown in Figure 4, generally, except for 1-step TD, all the variations converge finally to the expected average return of <span class="MathJax" id="MathJax-Element-197-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3457" style="width: 1.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.478em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3458"><span class="mn" id="MathJax-Span-3459" style="font-family: STIXGeneral-Regular;">200</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-197">200</script>. The 1-step TD fails to learn and achieve an average reward of around 10, which is possibly because of the complexity of the environment, where the bias in 1-step learning is too large and the learning diverges. It can also be observed that, with increasing <span class="MathJax" id="MathJax-Element-175-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2868" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2869"><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">n</script>, the variance increases, which also aligns with the fact that for Monte-Carlo methods compared with 1-step TD methods, the bias is low but the variance is high, and vice versa.</p>
<div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191019000604764.png" width="600" height="350" alt="N-steps" align="center"></div>
<center>Figure 4: Results for CartPole-v0.</center>
<p>Furthermore, observing the truncated results for 3000 steps in Figure 5, we can see that because of the relatively higher biases for smaller <span class="MathJax" id="MathJax-Element-175-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2868" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2869"><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">n</script>'s (40), the convergences are significantly slower. While for <span class="MathJax" id="MathJax-Element-198-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3460" style="width: 3.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.378em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.677em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3461"><span class="mi" id="MathJax-Span-3462" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3463" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-3464" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">150</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.904em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-198">n=150</script> and <span class="MathJax" id="MathJax-Element-199-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3465" style="width: 3.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.378em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3466"><span class="mi" id="MathJax-Span-3467" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3468" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-3469" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">200</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-199">n=200</script>, the convergence is fast.</p>
<div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191019001419372.png" width="600" height="350" alt="N-steps" align="center"></div>
<center>Figure 5: Results for CartPole-v0.</center>
<p>To summarize, by taking into consideration both the convergence stability and the convergence speed, a relatively good performance is observed for <span class="MathJax" id="MathJax-Element-200-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3470" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3471"><span class="mi" id="MathJax-Span-3472" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3473" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-3474" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">40</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-200">n=40</script>.</p>
<h3>4.2 Pendulum</h3>
<p>As shown in Figure 6, in general, the performance is not as good as the CartPole case, and convergence is hardly achieved. For <span class="MathJax" id="MathJax-Element-200-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3470" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3471"><span class="mi" id="MathJax-Span-3472" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3473" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-3474" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">40</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-200">n=40</script>, it is obvious that the learning curve tends to increase and converge, but for the other curves, given the high variance, no similar conclusions can be made. Nonetheless, the pattern with bias and variance trade-off w.r.t. <span class="MathJax" id="MathJax-Element-175-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2868" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2869"><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">n</script> can still be observed, as the standard deviations for smaller <span class="MathJax" id="MathJax-Element-175-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2868" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2869"><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">n</script>'s (1, 40) are relatively higher than those for larger <span class="MathJax" id="MathJax-Element-175-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2868" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2869"><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-175">n</script>'s (150, 200).</p>
<div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191019001710754.png" width="600" height="350" alt="N-steps" align="center"></div>
<center>Figure 6: Results for Pendulum-v0.</center>
<p>On the other hand, by observing the truncated results in Figure 7, it can be seen that for <span class="MathJax" id="MathJax-Element-200-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3470" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3471"><span class="mi" id="MathJax-Span-3472" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3473" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-3474" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">40</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-200">n=40</script>, there tends to be a faster convergence compared to the others.</p>
<div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191019001805732.png" width="600" height="350" alt="N-steps" align="center"></div>
<center>Figure 7: Results for Pendulum-v0.</center>
<p>To summarize, <span class="MathJax" id="MathJax-Element-200-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3470" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3471"><span class="mi" id="MathJax-Span-3472" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3473" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-3474" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">40</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-200">n=40</script> would be the preferable choice for this environment.</p>
<h2>Conclusion</h2>
<p>In this project, we investigate how different n for n-step bootstrapping could affect the learning behaviors of the A2C agent. We show that when using n=1, i.e., the TD method, the A2C agents are seldom capable of learning for both the CartPole and Pendulum environments.</p>
<p>While using MC, for the CartPole environment, the A2C agents are capable of learning with faster convergence but show a more volatile and unstable behaviors. However, for the Pendulum environment, convergence is not observed and future investigations need to be done. After the experiments, in general, we show that n-step bootstrapping achieves a relatively better performance in terms of convergence stability and the convergence speed compared to 1-step TD and MC by compensating between bias and variance. Hence, choosing an appropriate intermediate n could be vital for different application or problems in Reinforcement Learning.</p>
<h2>References</h2>
<blockquote>
<p>[1] Sutton, Richard S., and Andrew G. Barto. Reinforcement learning: An introduction. MIT press, 2018.<br>
[2] Schulman, John, et al. "High-dimensional continuous control using generalized advantage estimation." arXiv preprint arXiv:1506.02438 (2015).<br>
[3] Agarap, Abien Fred. "Deep learning using rectified linear units (relu)." arXiv preprint arXiv:1803.08375 (2018).</p>
</blockquote>
</div></div>
      <script>document.body.onkeyup = function(e) {
}</script>
    </body>
    </html>
  