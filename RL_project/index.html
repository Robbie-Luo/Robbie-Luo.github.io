<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="bootstrap.min.css">
  <!-- Custom fonts for this template -->
  <!-- common.css -->
  <style>
    * {
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }

    html {
      -webkit-text-size-adjust: none;
    }

    body {
       margin: 0;
      padding: 20px;
      color: #333;
      word-wrap: break-word;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      line-height: 1.2;
    }

    img {
      max-width: 100% !important;
      height: auto;
    }

    blockquote {
      margin: 0;
      padding: 0 15px;
      color: #777;
      border-left: 4px solid #ddd;
    }

    hr {
      background-color: #ddd;
      border: 0;
      height: 1px;
      margin: 15px 0;
    }

    code {
      font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;
      line-height: 1.4;
      margin: 0;
      padding: 0.2em 0;
      font-size: 90%;
      background-color: rgba(0, 0, 0, 0.04);
      border-radius: 3px;
    }

    pre>code {
      margin: 0;
      padding: 0;
      font-size: 100%;
      word-break: normal;
      background: transparent;
      border: 0;
    }

    ol {
      list-style-type: decimal;
    }

    ol ol,
    ul ol {
      list-style-type: lower-latin;
    }

    ol ol ol,
    ul ol ol,
    ul ul ol,
    ol ul ol {
      list-style-type: lower-roman;
    }

    table {
      border-spacing: 0;
      border-collapse: collapse;
      margin-top: 0;
      margin-bottom: 16px;
    }

    table th {
      font-weight: bold;
    }

    table th,
    table td {
      padding: 6px 13px;
      border: 1px solid #ddd;
    }

    table tr {
      border-top: 1px solid #ccc;
    }

    table tr:nth-child(even) {
      background-color: #f8f8f8;
    }

    input[type="checkbox"] {
      cursor: default;
      margin-right: 0.5em;
      font-size: 13px;
    }

    .task-list-item {
      list-style-type: none;
    }

    .task-list-item+.task-list-item {
      margin-top: 3px;
    }

    .task-list-item input {
      float: left;
      margin: 0.3em 1em 0.25em -1.6em;
      vertical-align: middle;
    }

    #tag-field {
      margin: 8px 2px 10px;
    }

    #tag-field .tag {
      display: inline-block;
      background: #cadff3;
      border-radius: 4px;
      padding: 1px 8px;
      color: black;
      font-size: 12px;
      margin-right: 10px;
      line-height: 1.4;
    }
  </style>
  <!-- ace-static.css -->
  <style>
    .ace_static_highlight {
      white-space: pre-wrap;
    }

    .ace_static_highlight .ace_gutter {
      width: 2em;
      text-align: right;
      padding: 0 3px 0 0;
      margin-right: 3px;
    }

    .ace_static_highlight.ace_show_gutter>.ace_line {
      padding-left: 2.6em;
    }

    .ace_static_highlight .ace_line {
      position: relative;
    }

    .ace_static_highlight .ace_gutter-cell {
      -moz-user-select: -moz-none;
      -khtml-user-select: none;
      -webkit-user-select: none;
      user-select: none;
      top: 0;
      bottom: 0;
      left: 0;
      position: absolute;
    }

    .ace_static_highlight .ace_gutter-cell:before {
      content: counter(ace_line, decimal);
      counter-increment: ace_line;
    }

    .ace_static_highlight {
      counter-reset: ace_line;
    }
  </style>
  <style>
    .ace-chrome .ace_gutter {
      background: #ebebeb;
      color: #333;
      overflow: hidden;
    }

    .ace-chrome .ace_print-margin {
      width: 1px;
      background: #e8e8e8;
    }

    .ace-chrome {
      background-color: #FFFFFF;
      color: black;
    }

    .ace-chrome .ace_cursor {
      color: black;
    }

    .ace-chrome .ace_invisible {
      color: rgb(191, 191, 191);
    }

    .ace-chrome .ace_constant.ace_buildin {
      color: rgb(88, 72, 246);
    }

    .ace-chrome .ace_constant.ace_language {
      color: rgb(88, 92, 246);
    }

    .ace-chrome .ace_constant.ace_library {
      color: rgb(6, 150, 14);
    }

    .ace-chrome .ace_invalid {
      background-color: rgb(153, 0, 0);
      color: white;
    }

    .ace-chrome .ace_fold {}

    .ace-chrome .ace_support.ace_function {
      color: rgb(60, 76, 114);
    }

    .ace-chrome .ace_support.ace_constant {
      color: rgb(6, 150, 14);
    }

    .ace-chrome .ace_support.ace_type,
    .ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {
      color: rgb(109, 121, 222);
    }

    .ace-chrome .ace_variable.ace_parameter {
      font-style: italic;
      color: #FD971F;
    }

    .ace-chrome .ace_keyword.ace_operator {
      color: rgb(104, 118, 135);
    }

    .ace-chrome .ace_comment {
      color: #236e24;
    }

    .ace-chrome .ace_comment.ace_doc {
      color: #236e24;
    }

    .ace-chrome .ace_comment.ace_doc.ace_tag {
      color: #236e24;
    }

    .ace-chrome .ace_constant.ace_numeric {
      color: rgb(0, 0, 205);
    }

    .ace-chrome .ace_variable {
      color: rgb(49, 132, 149);
    }

    .ace-chrome .ace_xml-pe {
      color: rgb(104, 104, 91);
    }

    .ace-chrome .ace_entity.ace_name.ace_function {
      color: #0000A2;
    }

    .ace-chrome .ace_heading {
      color: rgb(12, 7, 255);
    }

    .ace-chrome .ace_list {
      color: rgb(185, 6, 144);
    }

    .ace-chrome .ace_marker-layer .ace_selection {
      background: rgb(181, 213, 255);
    }

    .ace-chrome .ace_marker-layer .ace_step {
      background: rgb(252, 255, 0);
    }

    .ace-chrome .ace_marker-layer .ace_stack {
      background: rgb(164, 229, 101);
    }

    .ace-chrome .ace_marker-layer .ace_bracket {
      margin: -1px 0 0 -1px;
      border: 1px solid rgb(192, 192, 192);
    }

    .ace-chrome .ace_marker-layer .ace_active-line {
      background: rgba(0, 0, 0, 0.07);
    }

    .ace-chrome .ace_gutter-active-line {
      background-color: #dcdcdc;
    }

    .ace-chrome .ace_marker-layer .ace_selected-word {
      background: rgb(250, 250, 255);
      border: 1px solid rgb(200, 200, 250);
    }

    .ace-chrome .ace_storage,
    .ace-chrome .ace_keyword,
    .ace-chrome .ace_meta.ace_tag {
      color: rgb(147, 15, 128);
    }

    .ace-chrome .ace_string.ace_regex {
      color: rgb(255, 0, 0)
    }

    .ace-chrome .ace_string {
      color: #1A1AA6;
    }

    .ace-chrome .ace_entity.ace_other.ace_attribute-name {
      color: #994409;
    }

    .ace-chrome .ace_indent-guide {
      background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;
    }
  </style>
  <!-- export.css -->
  <style>
    body {
      margin: 0 auto;
      max-width: 800px;
      line-height: 1.4
    }

    #nav {
      margin: 5px 0 10px;
      font-size: 15px
    }

    #titlearea {
      border-bottom: 1px solid #ccc;
      font-size: 17px;
      padding: 10px 0;
    }

    #contentarea {
      font-size: 15px;
      margin: 16px 0
    }

    .cell {
      outline: 0;
      min-height: 20px;
      margin: 5px 0;
      padding: 5px 0;
    }

    .code-cell {
      font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;
      font-size: 12px;
    }

    .latex-cell {
      white-space: pre-wrap;
    }
  </style>
  <!-- User CSS -->
  <style>
    .text-cell {
      font-size: 15px;
    }

    .code-cell {
      font-size: 12px;
    }

    .markdown-cell {
      font-size: 15px;
      line-height: 1.5;
    }

    .latex-cell {
      font-size: 15px;
    }
  </style>
</head>

<body>
  <div id="titlearea">
    <h2>N-step Bootstrapping For Advantage Actor Critic</h2>
  </div>
  <div id="contentarea">
    <div class="cell markdown-cell">
      <blockquote>
        <p>by Xiaoxiao Wen, Yijie Zhang, Zhenyu Gao, Weitao Luo</p>
      </blockquote>
      <h2>1. Introduction and Motivation</h2>
      <p>In this project, we study N-step bootstrapping in actor critic methods <a
          href="https://www.cambridge.org/core/journals/robotica/article/robot-learning-edited-by-jonathan-h-connell-and-sridhar-mahadevan-kluwer-boston-19931997-xii240-pp-isbn-0792393651-hardback-21800-guilders-12000-8995/737FD21CA908246DF17779E9C20B6DF6">[1]</a>,
        more specific, we would like to investigate, when using N-step bootstrapping for advantage actor critic (A2C),
        how different values of <span class="MathJax" id="MathJax-Element-135-Frame" role="textbox" aria-readonly="true"
          style="">
          <nobr><span class="math" id="MathJax-Span-2196" style="width: 0.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2197"><span class="mi" id="MathJax-Span-2198"
                      style="font-family: STIXGeneral-Italic;">n</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-135">n</script> will affect the model performances, measured by
        different metrics, for example, convergence speed and stability (variance).
      </p>
      <h3>1.1 N-step bootstrapping</h3>
      <p>N-step bootstrapping <a
          href="https://www.cambridge.org/core/journals/robotica/article/robot-learning-edited-by-jonathan-h-connell-and-sridhar-mahadevan-kluwer-boston-19931997-xii240-pp-isbn-0792393651-hardback-21800-guilders-12000-8995/737FD21CA908246DF17779E9C20B6DF6">[1]</a>,
        or TD(N) is a very important technique in Reinforcement Learning that performs update based on intermediate
        number of rewards.</p>
      <p>In this view, N-step bootstrapping unifies and generalizes the Monte Carlo (MC) methods and Temporal Difference
        (TD) methods. From one extreme, when <span class="MathJax" id="MathJax-Element-136-Frame" role="textbox"
          aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2199" style="width: 2.891em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 2.59em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2200"><span class="mi" id="MathJax-Span-2201"
                      style="font-family: STIXGeneral-Italic;">N<span
                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span
                      class="mo" id="MathJax-Span-2202"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn"
                      id="MathJax-Span-2203"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.892em; vertical-align: -0.079em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-136">N=1</script>, it is equivalent to TD(1), from another extreme,
        when <span class="MathJax" id="MathJax-Element-137-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2204" style="width: 3.391em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2205"><span class="mi" id="MathJax-Span-2206"
                      style="font-family: STIXGeneral-Italic;">N<span
                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span
                      class="mo" id="MathJax-Span-2207"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi"
                      id="MathJax-Span-2208"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∞</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.079em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-137">N=\infty</script>, i.e., taking as many steps as possible until
        the end of the episode, it becomes MC.
      </p>
      <p>As a result, N-step bootstrapping also combines the advantages of Monte Carlo and 1-step TD. Compared to 1-step
        TD, N-step bootstrapping will converge faster because it bootstraps with more real information and it is freed
        from the “tyranny of the time step”. Compared to MC, the updates do not have to wait until the end of the
        episode and it is also more efficient and less variants. In general, when facing different problems /
        situations, with a suitable N, we could often achieve faster and more stable learning.</p>
      <div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191014053755194.png" width="300"
          height="300" alt="N-steps" align="center"></div>
      <center>Figure1: Diagrams for N-step bootstrapping.</center>
      <h3>1.2 Advantage Actor Critic (A2C)</h3>
      <p>Actor-Critic algorithms are a power families of learning algorithms within the policy-based framework in
        Reinforcement Learning. It composes of actor, the policy that makes decision and critic, the value function that
        evaluates if it is a good decision. With the assistant from critic, the actor can usually achieves better
        performance, such as by reducing gradient variance in vanilla policy gradients.</p>
      <p>From the <a href="https://arxiv.org/pdf/1506.02438v3.pdf">GAE paper</a> <a
          href="https://arxiv.org/abs/1506.02438">[2]</a>, John Schulman has unified the framework for advantage
        estimation, between all the GAE variants, we picked A2C considering the amazing performance of A3C and it is a
        simplified version of A3C with equivalent performance.</p>
      <p>In the following sections, we first explain the method of N-step Bootstrapping for A2C, which also includes
        1-step and Monte-Carlo as mentioned above, and then briefly introduce the neural network architecture.
        Subsequently, we introduce the conducted experiments with their corresponding settings and finally we discuss
        the results and draw some conclusions.</p>
      <h2>2. Methods</h2>
      <h3>2.1 N-step Bootstrapping for A2C</h3>
      <p>N-step A2C is an online algorithm that uses roll-outs of size n + 1 of the current policy to perform a policy
        improvement step. In order to train the policy-head, an approximation of the policy-gradient is computed for
        each state of the roll-out <span class="MathJax" id="MathJax-Element-138-Frame" role="textbox"
          aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2209" style="width: 15.891em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 14.302em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.123em, 1000em, 2.775em, -0.368em); top: -2.196em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2210"><span class="msubsup" id="MathJax-Span-2211"><span
                        style="display: inline-block; position: relative; width: 14.264em; height: 0px;"><span
                          style="position: absolute; clip: rect(1.95em, 1000em, 3.518em, -0.368em); top: -2.984em; left: 0em;"><span
                            class="mrow" id="MathJax-Span-2212"><span class="mo" id="MathJax-Span-2213"
                              style="vertical-align: -0.201em;"><span
                                style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                              id="MathJax-Span-2214"><span
                                style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                                  style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                    class="mi" id="MathJax-Span-2215" style="font-family: STIXGeneral-Italic;">x<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                  style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom"
                                    id="MathJax-Span-2216"><span class="mrow" id="MathJax-Span-2217"><span class="mi"
                                        id="MathJax-Span-2218"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                        class="mo" id="MathJax-Span-2219"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span
                                        class="mi" id="MathJax-Span-2220"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                    style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                              class="mo" id="MathJax-Span-2221" style="font-family: STIXGeneral-Regular;">,</span><span
                              class="msubsup" id="MathJax-Span-2222" style="padding-left: 0.188em;"><span
                                style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span
                                  style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span
                                    class="mi" id="MathJax-Span-2223"
                                    style="font-family: STIXGeneral-Italic;">a</span><span
                                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                  style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom"
                                    id="MathJax-Span-2224"><span class="mrow" id="MathJax-Span-2225"><span class="mi"
                                        id="MathJax-Span-2226"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                        class="mo" id="MathJax-Span-2227"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span
                                        class="mi" id="MathJax-Span-2228"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                    style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                              class="mo" id="MathJax-Span-2229"
                              style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="mi"
                              id="MathJax-Span-2230"
                              style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">π<span
                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span
                              class="mrow" id="MathJax-Span-2231" style="padding-left: 0.188em;"><span class="mo"
                                id="MathJax-Span-2232" style="vertical-align: -0.201em;"><span
                                  style="font-family: STIXSizeOneSym;">(</span></span><span class="mo"
                                id="MathJax-Span-2233" style="font-family: STIXGeneral-Regular;">⋅</span><span
                                class="texatom" id="MathJax-Span-2234"><span class="mrow" id="MathJax-Span-2235"><span
                                    class="mo" id="MathJax-Span-2236"
                                    style="font-family: STIXGeneral-Regular;">|</span></span></span><span
                                class="msubsup" id="MathJax-Span-2237"><span
                                  style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                                    style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                      class="mi" id="MathJax-Span-2238" style="font-family: STIXGeneral-Italic;">x<span
                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                    style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom"
                                      id="MathJax-Span-2239"><span class="mrow" id="MathJax-Span-2240"><span class="mi"
                                          id="MathJax-Span-2241"
                                          style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                          class="mo" id="MathJax-Span-2242"
                                          style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span
                                          class="mi" id="MathJax-Span-2243"
                                          style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                class="mo" id="MathJax-Span-2244"
                                style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup"
                                id="MathJax-Span-2245" style="padding-left: 0.188em;"><span
                                  style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span
                                    style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                      class="mi" id="MathJax-Span-2246" style="font-family: STIXGeneral-Italic;">θ<span
                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                    style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom"
                                      id="MathJax-Span-2247"><span class="mrow" id="MathJax-Span-2248"><span class="mi"
                                          id="MathJax-Span-2249"
                                          style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span
                                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                class="mo" id="MathJax-Span-2250" style="vertical-align: -0.201em;"><span
                                  style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo"
                              id="MathJax-Span-2251"
                              style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span
                              class="msubsup" id="MathJax-Span-2252" style="padding-left: 0.188em;"><span
                                style="display: inline-block; position: relative; width: 1.46em; height: 0px;"><span
                                  style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span
                                    class="mi" id="MathJax-Span-2253" style="font-family: STIXGeneral-Italic;">r<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span
                                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                  style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom"
                                    id="MathJax-Span-2254"><span class="mrow" id="MathJax-Span-2255"><span class="mi"
                                        id="MathJax-Span-2256"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                        class="mo" id="MathJax-Span-2257"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span
                                        class="mi" id="MathJax-Span-2258"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                    style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                              class="mo" id="MathJax-Span-2259" style="vertical-align: -0.201em;"><span
                                style="font-family: STIXSizeOneSym;">)</span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span
                          style="position: absolute; clip: rect(1.828em, 1000em, 2.484em, -0.497em); top: -2.901em; left: 13.063em;"><span
                            class="texatom" id="MathJax-Span-2260"><span class="mrow" id="MathJax-Span-2261"><span
                                class="mi" id="MathJax-Span-2262"
                                style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                          style="position: absolute; clip: rect(1.662em, 1000em, 2.487em, -0.472em); top: -1.908em; left: 13.063em;"><span
                            class="texatom" id="MathJax-Span-2263"><span class="mrow" id="MathJax-Span-2264"><span
                                class="mi" id="MathJax-Span-2265"
                                style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo"
                                id="MathJax-Span-2266"
                                style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn"
                                id="MathJax-Span-2267"
                                style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.584em; vertical-align: -0.518em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-138">
          \left(x_{t+i}, a_{t+i} \sim \pi\left(\cdot | x_{t+i} ; \theta_{\pi}\right), r_{t+i}\right)_{i=0}^{n}</script>,
        expressed as<br>
      </p>
      <div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax"
          id="MathJax-Element-139-Frame" style="">
          <nobr><span class="math" id="MathJax-Span-2268" style="width: 21.203em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 19.088em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(2.15em, 1000em, 4.332em, -0.444em); top: -3.491em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2269"><span class="msubsup" id="MathJax-Span-2270"><span
                        style="display: inline-block; position: relative; width: 1.582em; height: 0px;"><span
                          style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span
                            class="mi" id="MathJax-Span-2271" style="font-family: STIXGeneral-Regular;">∇</span><span
                            style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                          style="position: absolute; top: -3.848em; left: 0.788em;"><span class="texatom"
                            id="MathJax-Span-2272"><span class="mrow" id="MathJax-Span-2273"><span class="msubsup"
                                id="MathJax-Span-2274"><span
                                  style="display: inline-block; position: relative; width: 0.719em; height: 0px;"><span
                                    style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span
                                      class="mi" id="MathJax-Span-2275"
                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span
                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                                    style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom"
                                      id="MathJax-Span-2276"><span class="mrow" id="MathJax-Span-2277"><span class="mi"
                                          id="MathJax-Span-2278"
                                          style="font-size: 50%; font-family: STIXGeneral-Italic;">π<span
                                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span
                            style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span
                      class="mi" id="MathJax-Span-2279"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mrow"
                      id="MathJax-Span-2280" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2281"
                        style="vertical-align: -0.201em;"><span
                          style="font-family: STIXSizeOneSym;">(</span></span><span class="mi" id="MathJax-Span-2282"
                        style="font-family: STIXGeneral-Italic;">π<span
                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span
                        class="mrow" id="MathJax-Span-2283" style="padding-left: 0.188em;"><span class="mo"
                          id="MathJax-Span-2284" style="vertical-align: -0.201em;"><span
                            style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                          id="MathJax-Span-2285"><span
                            style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2286" style="font-family: STIXGeneral-Italic;">a</span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom"
                                id="MathJax-Span-2287"><span class="mrow" id="MathJax-Span-2288"><span class="mi"
                                    id="MathJax-Span-2289"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                    class="mo" id="MathJax-Span-2290"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi"
                                    id="MathJax-Span-2291"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="texatom" id="MathJax-Span-2292"><span class="mrow" id="MathJax-Span-2293"><span
                              class="mo" id="MathJax-Span-2294"
                              style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup"
                          id="MathJax-Span-2295"><span
                            style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2296" style="font-family: STIXGeneral-Italic;">x<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom"
                                id="MathJax-Span-2297"><span class="mrow" id="MathJax-Span-2298"><span class="mi"
                                    id="MathJax-Span-2299"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                    class="mo" id="MathJax-Span-2300"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi"
                                    id="MathJax-Span-2301"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="mo" id="MathJax-Span-2302" style="font-family: STIXGeneral-Regular;">;</span><span
                          class="msubsup" id="MathJax-Span-2303" style="padding-left: 0.188em;"><span
                            style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2304" style="font-family: STIXGeneral-Italic;">θ<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom"
                                id="MathJax-Span-2305"><span class="mrow" id="MathJax-Span-2306"><span class="mi"
                                    id="MathJax-Span-2307"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="mo" id="MathJax-Span-2308" style="vertical-align: -0.201em;"><span
                            style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo"
                        id="MathJax-Span-2309" style="vertical-align: -0.201em;"><span
                          style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mrow"
                      id="MathJax-Span-2310" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2311"
                        style="vertical-align: -0.393em; padding-left: 0.188em;"><span
                          style="font-family: STIXSizeTwoSym;">[</span></span><span class="msubsup"
                        id="MathJax-Span-2312"><span
                          style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span
                            style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span
                              class="texatom" id="MathJax-Span-2313"><span class="mrow" id="MathJax-Span-2314"><span
                                  class="munderover" id="MathJax-Span-2315"><span
                                    style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span
                                      style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span
                                        class="mi" id="MathJax-Span-2316"
                                        style="font-family: STIXGeneral-Italic;">Q</span><span
                                        style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                      style="position: absolute; top: -4.298em; left: 0.21em;"><span
                                        style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span
                                        class="mo" id="MathJax-Span-2317"
                                        style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span
                                          style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span
                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span
                                        style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span
                              style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span
                            style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom"
                              id="MathJax-Span-2318"><span class="mrow" id="MathJax-Span-2319"><span class="mi"
                                  id="MathJax-Span-2320"
                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                        class="mo" id="MathJax-Span-2321"
                        style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi"
                        id="MathJax-Span-2322" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span
                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span
                        class="mrow" id="MathJax-Span-2323" style="padding-left: 0.188em;"><span class="mo"
                          id="MathJax-Span-2324" style="vertical-align: -0.201em;"><span
                            style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                          id="MathJax-Span-2325"><span
                            style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2326" style="font-family: STIXGeneral-Italic;">x<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom"
                                id="MathJax-Span-2327"><span class="mrow" id="MathJax-Span-2328"><span class="mi"
                                    id="MathJax-Span-2329"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                    class="mo" id="MathJax-Span-2330"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi"
                                    id="MathJax-Span-2331"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="mo" id="MathJax-Span-2332" style="font-family: STIXGeneral-Regular;">;</span><span
                          class="msubsup" id="MathJax-Span-2333" style="padding-left: 0.188em;"><span
                            style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2334" style="font-family: STIXGeneral-Italic;">θ<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom"
                                id="MathJax-Span-2335"><span class="mrow" id="MathJax-Span-2336"><span class="mi"
                                    id="MathJax-Span-2337"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="mo" id="MathJax-Span-2338" style="vertical-align: -0.201em;"><span
                            style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo"
                        id="MathJax-Span-2339" style="vertical-align: -0.393em;"><span
                          style="font-family: STIXSizeTwoSym;">]</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 3.491em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.173em; vertical-align: -0.809em;"></span></span>
          </nobr>
        </span></div>
      <script type="math/tex; mode=display" id="MathJax-Element-139">
        \nabla_{\theta_{\pi}} \log \left(\pi\left(a_{t+i} | x_{t+i} ; \theta_{\pi}\right)\right)\left[\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right] 
      </script><br>
      where <span class="MathJax" id="MathJax-Element-140-Frame" role="textbox" aria-readonly="true" style="">
        <nobr><span class="math" id="MathJax-Span-2340" style="width: 1.203em; display: inline-block;"><span
              style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 111%;"><span
                style="position: absolute; clip: rect(1.053em, 1000em, 2.59em, -0.682em); top: -2.196em; left: 0em;"><span
                  class="mrow" id="MathJax-Span-2341"><span class="msubsup" id="MathJax-Span-2342"><span
                      style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span
                        style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span
                          class="texatom" id="MathJax-Span-2343"><span class="mrow" id="MathJax-Span-2344"><span
                              class="munderover" id="MathJax-Span-2345"><span
                                style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span
                                  style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span
                                    class="mi" id="MathJax-Span-2346"
                                    style="font-family: STIXGeneral-Italic;">Q</span><span
                                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                  style="position: absolute; top: -4.298em; left: 0.21em;"><span
                                    style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span
                                    class="mo" id="MathJax-Span-2347"
                                    style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span
                                      style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span
                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span
                                    style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span
                          style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span
                        style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom"
                          id="MathJax-Span-2348"><span class="mrow" id="MathJax-Span-2349"><span class="mi"
                              id="MathJax-Span-2350"
                              style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                          style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span
                  style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span
              style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.456em; vertical-align: -0.312em;"></span></span>
        </nobr>
      </span>
      <script type="math/tex" id="MathJax-Element-140">\hat{Q}_{i}</script> is an estimation of the return <span
        class="MathJax" id="MathJax-Element-141-Frame" role="textbox" aria-readonly="true" style="">
        <nobr><span class="math" id="MathJax-Span-2351" style="width: 17.578em; display: inline-block;"><span
              style="display: inline-block; position: relative; width: 15.822em; height: 0px; font-size: 111%;"><span
                style="position: absolute; clip: rect(1.842em, 1000em, 3.596em, -0.682em); top: -2.984em; left: 0em;"><span
                  class="mrow" id="MathJax-Span-2352"><span class="msubsup" id="MathJax-Span-2353"><span
                      style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span
                        style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span
                          class="texatom" id="MathJax-Span-2354"><span class="mrow" id="MathJax-Span-2355"><span
                              class="munderover" id="MathJax-Span-2356"><span
                                style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span
                                  style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span
                                    class="mi" id="MathJax-Span-2357"
                                    style="font-family: STIXGeneral-Italic;">Q</span><span
                                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                  style="position: absolute; top: -4.298em; left: 0.21em;"><span
                                    style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span
                                    class="mo" id="MathJax-Span-2358"
                                    style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span
                                      style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span
                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span
                                    style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span
                          style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span
                        style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom"
                          id="MathJax-Span-2359"><span class="mrow" id="MathJax-Span-2360"><span class="mi"
                              id="MathJax-Span-2361"
                              style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                          style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                    class="mo" id="MathJax-Span-2362"
                    style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover"
                    id="MathJax-Span-2363" style="padding-left: 0.313em;"><span
                      style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span
                        style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span
                          class="mo" id="MathJax-Span-2364"
                          style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span
                          style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span
                        style="position: absolute; clip: rect(1.662em, 1000em, 2.484em, -0.497em); top: -2.797em; left: 0.957em;"><span
                          class="texatom" id="MathJax-Span-2365"><span class="mrow" id="MathJax-Span-2366"><span
                              class="mi" id="MathJax-Span-2367"
                              style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo"
                              id="MathJax-Span-2368"
                              style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn"
                              id="MathJax-Span-2369"
                              style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span
                          style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                        style="position: absolute; clip: rect(1.677em, 1000em, 2.624em, -0.594em); top: -2.012em; left: 0.957em;"><span
                          class="texatom" id="MathJax-Span-2370"><span class="mrow" id="MathJax-Span-2371"><span
                              class="mi" id="MathJax-Span-2372"
                              style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span
                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span
                              class="mo" id="MathJax-Span-2373"
                              style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi"
                              id="MathJax-Span-2374"
                              style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                          style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                    class="msubsup" id="MathJax-Span-2375" style="padding-left: 0.188em;"><span
                      style="display: inline-block; position: relative; width: 1.541em; height: 0px;"><span
                        style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span
                          class="mi" id="MathJax-Span-2376" style="font-family: STIXGeneral-Italic;">γ<span
                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span
                          style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                        style="position: absolute; top: -2.671em; left: 0.509em;"><span class="texatom"
                          id="MathJax-Span-2377"><span class="mrow" id="MathJax-Span-2378"><span class="mi"
                              id="MathJax-Span-2379" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span
                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span
                              class="mo" id="MathJax-Span-2380"
                              style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi"
                              id="MathJax-Span-2381"
                              style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                          style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                    class="msubsup" id="MathJax-Span-2382"><span
                      style="display: inline-block; position: relative; width: 1.46em; height: 0px;"><span
                        style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span
                          class="mi" id="MathJax-Span-2383" style="font-family: STIXGeneral-Italic;">r<span
                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span
                          style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                        style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom"
                          id="MathJax-Span-2384"><span class="mrow" id="MathJax-Span-2385"><span class="mi"
                              id="MathJax-Span-2386" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                              class="mo" id="MathJax-Span-2387"
                              style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi"
                              id="MathJax-Span-2388" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span
                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span
                          style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                    class="mo" id="MathJax-Span-2389"
                    style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup"
                    id="MathJax-Span-2390" style="padding-left: 0.25em;"><span
                      style="display: inline-block; position: relative; width: 1.71em; height: 0px;"><span
                        style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span
                          class="mi" id="MathJax-Span-2391" style="font-family: STIXGeneral-Italic;">γ<span
                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span
                          style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                        style="position: absolute; top: -2.671em; left: 0.509em;"><span class="texatom"
                          id="MathJax-Span-2392"><span class="mrow" id="MathJax-Span-2393"><span class="mi"
                              id="MathJax-Span-2394"
                              style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo"
                              id="MathJax-Span-2395"
                              style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi"
                              id="MathJax-Span-2396"
                              style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                          style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                    class="mi" id="MathJax-Span-2397" style="font-family: STIXGeneral-Italic;">V<span
                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span
                    class="mrow" id="MathJax-Span-2398" style="padding-left: 0.188em;"><span class="mo"
                      id="MathJax-Span-2399" style="vertical-align: -0.201em;"><span
                        style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                      id="MathJax-Span-2400"><span
                        style="display: inline-block; position: relative; width: 1.705em; height: 0px;"><span
                          style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                            class="mi" id="MathJax-Span-2401" style="font-family: STIXGeneral-Italic;">x<span
                              style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                            style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                          style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom"
                            id="MathJax-Span-2402"><span class="mrow" id="MathJax-Span-2403"><span class="mi"
                                id="MathJax-Span-2404" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                class="mo" id="MathJax-Span-2405"
                                style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi"
                                id="MathJax-Span-2406"
                                style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                      class="mo" id="MathJax-Span-2407" style="font-family: STIXGeneral-Regular;">;</span><span
                      class="msubsup" id="MathJax-Span-2408" style="padding-left: 0.188em;"><span
                        style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span
                          style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                            class="mi" id="MathJax-Span-2409" style="font-family: STIXGeneral-Italic;">θ<span
                              style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                            style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                          style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom"
                            id="MathJax-Span-2410"><span class="mrow" id="MathJax-Span-2411"><span class="mi"
                                id="MathJax-Span-2412" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                      class="mo" id="MathJax-Span-2413" style="vertical-align: -0.201em;"><span
                        style="font-family: STIXSizeOneSym;">)</span></span></span></span><span
                  style="display: inline-block; width: 0px; height: 2.984em;"></span></span></span><span
              style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.697em; vertical-align: -0.554em;"></span></span>
        </nobr>
      </span>
      <script type="math/tex" id="MathJax-Element-141">
        \hat{Q}_{i}=\sum_{j=i}^{n-1} \gamma^{j-i} r_{t+j}+\gamma^{n-i} V\left(x_{t+n} ; \theta_{V}\right)</script>. The
      gradients <span class="MathJax" id="MathJax-Element-142-Frame" role="textbox" aria-readonly="true" style="">
        <nobr><span class="math" id="MathJax-Span-2414" style="width: 2.141em; display: inline-block;"><span
              style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 111%;"><span
                style="position: absolute; clip: rect(1.711em, 1000em, 2.91em, -0.631em); top: -2.534em; left: 0em;"><span
                  class="mrow" id="MathJax-Span-2415"><span class="mi" id="MathJax-Span-2416"
                    style="font-family: STIXGeneral-Italic;">j<span
                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span
                    class="mo" id="MathJax-Span-2417"
                    style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi"
                    id="MathJax-Span-2418"
                    style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">i</span></span><span
                  style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
              style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.081em; vertical-align: -0.292em;"></span></span>
        </nobr>
      </span>
      <script type="math/tex" id="MathJax-Element-142">j=i</script><br>
      are then added to obtain the cumulative gradient of the roll-out as<br>
      <div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax"
          id="MathJax-Element-143-Frame" style="">
          <nobr><span class="math" id="MathJax-Span-2419" style="width: 22.953em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 20.664em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.71em, 1000em, 4.92em, -0.417em); top: -3.491em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2420"><span class="munderover" id="MathJax-Span-2421"><span
                        style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span
                          style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span
                            class="mo" id="MathJax-Span-2422"
                            style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span
                            style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span
                          style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.472em); top: -1.159em; left: 0.113em;"><span
                            class="texatom" id="MathJax-Span-2423"><span class="mrow" id="MathJax-Span-2424"><span
                                class="mi" id="MathJax-Span-2425"
                                style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo"
                                id="MathJax-Span-2426"
                                style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn"
                                id="MathJax-Span-2427"
                                style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                          style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.497em); top: -3.509em; left: 0.479em;"><span
                            class="texatom" id="MathJax-Span-2428"><span class="mrow" id="MathJax-Span-2429"><span
                                class="mi" id="MathJax-Span-2430"
                                style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                      class="msubsup" id="MathJax-Span-2431" style="padding-left: 0.188em;"><span
                        style="display: inline-block; position: relative; width: 1.582em; height: 0px;"><span
                          style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span
                            class="mi" id="MathJax-Span-2432" style="font-family: STIXGeneral-Regular;">∇</span><span
                            style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                          style="position: absolute; top: -3.848em; left: 0.788em;"><span class="texatom"
                            id="MathJax-Span-2433"><span class="mrow" id="MathJax-Span-2434"><span class="msubsup"
                                id="MathJax-Span-2435"><span
                                  style="display: inline-block; position: relative; width: 0.719em; height: 0px;"><span
                                    style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span
                                      class="mi" id="MathJax-Span-2436"
                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span
                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                                    style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom"
                                      id="MathJax-Span-2437"><span class="mrow" id="MathJax-Span-2438"><span class="mi"
                                          id="MathJax-Span-2439"
                                          style="font-size: 50%; font-family: STIXGeneral-Italic;">π<span
                                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span
                            style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span
                      class="mi" id="MathJax-Span-2440"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mrow"
                      id="MathJax-Span-2441" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2442"
                        style="vertical-align: -0.201em;"><span
                          style="font-family: STIXSizeOneSym;">(</span></span><span class="mi" id="MathJax-Span-2443"
                        style="font-family: STIXGeneral-Italic;">π<span
                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span
                        class="mrow" id="MathJax-Span-2444" style="padding-left: 0.188em;"><span class="mo"
                          id="MathJax-Span-2445" style="vertical-align: -0.201em;"><span
                            style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                          id="MathJax-Span-2446"><span
                            style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2447" style="font-family: STIXGeneral-Italic;">a</span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom"
                                id="MathJax-Span-2448"><span class="mrow" id="MathJax-Span-2449"><span class="mi"
                                    id="MathJax-Span-2450"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                    class="mo" id="MathJax-Span-2451"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi"
                                    id="MathJax-Span-2452"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="texatom" id="MathJax-Span-2453"><span class="mrow" id="MathJax-Span-2454"><span
                              class="mo" id="MathJax-Span-2455"
                              style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup"
                          id="MathJax-Span-2456"><span
                            style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2457" style="font-family: STIXGeneral-Italic;">x<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom"
                                id="MathJax-Span-2458"><span class="mrow" id="MathJax-Span-2459"><span class="mi"
                                    id="MathJax-Span-2460"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                    class="mo" id="MathJax-Span-2461"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi"
                                    id="MathJax-Span-2462"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="mo" id="MathJax-Span-2463" style="font-family: STIXGeneral-Regular;">;</span><span
                          class="msubsup" id="MathJax-Span-2464" style="padding-left: 0.188em;"><span
                            style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2465" style="font-family: STIXGeneral-Italic;">θ<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom"
                                id="MathJax-Span-2466"><span class="mrow" id="MathJax-Span-2467"><span class="mi"
                                    id="MathJax-Span-2468"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="mo" id="MathJax-Span-2469" style="vertical-align: -0.201em;"><span
                            style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo"
                        id="MathJax-Span-2470" style="vertical-align: -0.201em;"><span
                          style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mrow"
                      id="MathJax-Span-2471" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2472"
                        style="vertical-align: -0.393em; padding-left: 0.188em;"><span
                          style="font-family: STIXSizeTwoSym;">[</span></span><span class="msubsup"
                        id="MathJax-Span-2473"><span
                          style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span
                            style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span
                              class="texatom" id="MathJax-Span-2474"><span class="mrow" id="MathJax-Span-2475"><span
                                  class="munderover" id="MathJax-Span-2476"><span
                                    style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span
                                      style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span
                                        class="mi" id="MathJax-Span-2477"
                                        style="font-family: STIXGeneral-Italic;">Q</span><span
                                        style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                      style="position: absolute; top: -4.298em; left: 0.21em;"><span
                                        style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span
                                        class="mo" id="MathJax-Span-2478"
                                        style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span
                                          style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span
                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span
                                        style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span
                              style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span
                            style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom"
                              id="MathJax-Span-2479"><span class="mrow" id="MathJax-Span-2480"><span class="mi"
                                  id="MathJax-Span-2481"
                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                        class="mo" id="MathJax-Span-2482"
                        style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi"
                        id="MathJax-Span-2483" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span
                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span
                        class="mrow" id="MathJax-Span-2484" style="padding-left: 0.188em;"><span class="mo"
                          id="MathJax-Span-2485" style="vertical-align: -0.201em;"><span
                            style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                          id="MathJax-Span-2486"><span
                            style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2487" style="font-family: STIXGeneral-Italic;">x<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom"
                                id="MathJax-Span-2488"><span class="mrow" id="MathJax-Span-2489"><span class="mi"
                                    id="MathJax-Span-2490"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                    class="mo" id="MathJax-Span-2491"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi"
                                    id="MathJax-Span-2492"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="mo" id="MathJax-Span-2493" style="font-family: STIXGeneral-Regular;">;</span><span
                          class="msubsup" id="MathJax-Span-2494" style="padding-left: 0.188em;"><span
                            style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                class="mi" id="MathJax-Span-2495" style="font-family: STIXGeneral-Italic;">θ<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                              style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom"
                                id="MathJax-Span-2496"><span class="mrow" id="MathJax-Span-2497"><span class="mi"
                                    id="MathJax-Span-2498"
                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                      style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                          class="mo" id="MathJax-Span-2499" style="vertical-align: -0.201em;"><span
                            style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo"
                        id="MathJax-Span-2500" style="vertical-align: -0.393em;"><span
                          style="font-family: STIXSizeTwoSym;">]</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 3.491em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.313em; vertical-align: -1.461em;"></span></span>
          </nobr>
        </span></div>
      <script type="math/tex; mode=display" id="MathJax-Element-143">
        \sum_{i=0}^{n} \nabla_{\theta_{\pi}} \log \left(\pi\left(a_{t+i} | x_{t+i} ; \theta_{\pi}\right)\right)\left[\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right] 
      </script><br>
      A2C trains the value-head by minimising the error between the estimated return and the value as<br>
      <div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax"
          id="MathJax-Element-144-Frame" style="">
          <nobr><span class="math" id="MathJax-Span-2501" style="width: 11.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 10.417em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(0.415em, 1000em, 3.625em, -0.417em); top: -2.196em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2502"><span class="munderover" id="MathJax-Span-2503"><span
                        style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span
                          style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span
                            class="mo" id="MathJax-Span-2504"
                            style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span
                            style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span
                          style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.472em); top: -1.159em; left: 0.113em;"><span
                            class="texatom" id="MathJax-Span-2505"><span class="mrow" id="MathJax-Span-2506"><span
                                class="mi" id="MathJax-Span-2507"
                                style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo"
                                id="MathJax-Span-2508"
                                style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn"
                                id="MathJax-Span-2509"
                                style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                          style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.497em); top: -3.509em; left: 0.479em;"><span
                            class="texatom" id="MathJax-Span-2510"><span class="mrow" id="MathJax-Span-2511"><span
                                class="mi" id="MathJax-Span-2512"
                                style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                      class="msubsup" id="MathJax-Span-2513" style="padding-left: 0.188em;"><span
                        style="display: inline-block; position: relative; width: 8.859em; height: 0px;"><span
                          style="position: absolute; clip: rect(2.15em, 1000em, 4.332em, -0.368em); top: -3.491em; left: 0em;"><span
                            class="mrow" id="MathJax-Span-2514"><span class="mo" id="MathJax-Span-2515"
                              style="vertical-align: -0.393em;"><span
                                style="font-family: STIXSizeTwoSym;">(</span></span><span class="msubsup"
                              id="MathJax-Span-2516"><span
                                style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span
                                  style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span
                                    class="texatom" id="MathJax-Span-2517"><span class="mrow"
                                      id="MathJax-Span-2518"><span class="munderover" id="MathJax-Span-2519"><span
                                          style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span
                                              class="mi" id="MathJax-Span-2520"
                                              style="font-family: STIXGeneral-Italic;">Q</span><span
                                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                            style="position: absolute; top: -4.298em; left: 0.21em;"><span
                                              style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span
                                              class="mo" id="MathJax-Span-2521"
                                              style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span
                                                style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span
                                              style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span
                                              style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span
                                    style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span
                                  style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom"
                                    id="MathJax-Span-2522"><span class="mrow" id="MathJax-Span-2523"><span class="mi"
                                        id="MathJax-Span-2524"
                                        style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                    style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                              class="mo" id="MathJax-Span-2525"
                              style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi"
                              id="MathJax-Span-2526"
                              style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span
                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span
                              class="mrow" id="MathJax-Span-2527" style="padding-left: 0.188em;"><span class="mo"
                                id="MathJax-Span-2528" style="vertical-align: -0.201em;"><span
                                  style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                                id="MathJax-Span-2529"><span
                                  style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                                    style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                      class="mi" id="MathJax-Span-2530" style="font-family: STIXGeneral-Italic;">x<span
                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                    style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom"
                                      id="MathJax-Span-2531"><span class="mrow" id="MathJax-Span-2532"><span class="mi"
                                          id="MathJax-Span-2533"
                                          style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                          class="mo" id="MathJax-Span-2534"
                                          style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span
                                          class="mi" id="MathJax-Span-2535"
                                          style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                class="mo" id="MathJax-Span-2536"
                                style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup"
                                id="MathJax-Span-2537" style="padding-left: 0.188em;"><span
                                  style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span
                                    style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                      class="mi" id="MathJax-Span-2538" style="font-family: STIXGeneral-Italic;">θ<span
                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                    style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom"
                                      id="MathJax-Span-2539"><span class="mrow" id="MathJax-Span-2540"><span class="mi"
                                          id="MathJax-Span-2541"
                                          style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                                      style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                class="mo" id="MathJax-Span-2542" style="vertical-align: -0.201em;"><span
                                  style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo"
                              id="MathJax-Span-2543" style="vertical-align: -0.393em;"><span
                                style="font-family: STIXSizeTwoSym;">)</span></span></span><span
                            style="display: inline-block; width: 0px; height: 3.491em;"></span></span><span
                          style="position: absolute; top: -3.208em; left: 8.39em;"><span class="texatom"
                            id="MathJax-Span-2544"><span class="mrow" id="MathJax-Span-2545"><span class="mn"
                                id="MathJax-Span-2546"
                                style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.313em; vertical-align: -1.461em;"></span></span>
          </nobr>
        </span></div>
      <script type="math/tex; mode=display" id="MathJax-Element-144">
        \sum_{i=0}^{n}\left(\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right)^{2}</script>
      <p></p>
      <p>Therefore, the network parameters <span class="MathJax" id="MathJax-Element-145-Frame" role="textbox"
          aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2547" style="width: 3.828em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 3.435em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.95em, 1000em, 3.518em, -0.368em); top: -2.984em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2548"><span class="mrow" id="MathJax-Span-2549"><span class="mo"
                        id="MathJax-Span-2550" style="vertical-align: -0.201em;"><span
                          style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                        id="MathJax-Span-2551"><span
                          style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span
                            style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                              class="mi" id="MathJax-Span-2552" style="font-family: STIXGeneral-Italic;">θ<span
                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                            style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom"
                              id="MathJax-Span-2553"><span class="mrow" id="MathJax-Span-2554"><span class="mi"
                                  id="MathJax-Span-2555"
                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span
                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span
                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                        class="mo" id="MathJax-Span-2556" style="font-family: STIXGeneral-Regular;">,</span><span
                        class="msubsup" id="MathJax-Span-2557" style="padding-left: 0.188em;"><span
                          style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span
                            style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                              class="mi" id="MathJax-Span-2558" style="font-family: STIXGeneral-Italic;">θ<span
                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                            style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom"
                              id="MathJax-Span-2559"><span class="mrow" id="MathJax-Span-2560"><span class="mi"
                                  id="MathJax-Span-2561"
                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                        class="mo" id="MathJax-Span-2562" style="vertical-align: -0.201em;"><span
                          style="font-family: STIXSizeOneSym;">)</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.984em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.49em; vertical-align: -0.468em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-145">\left(\theta_{\pi}, \theta_{V}\right)</script> are updated
        after each roll-out as follows:<br>
      </p>
      <div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax"
          id="MathJax-Element-146-Frame" style="">
          <nobr><span class="math" id="MathJax-Span-2563" style="width: 29.891em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 26.914em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(-1.32em, 1000em, 5.212em, -0.313em); top: -2.196em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2564"><span class="mtable" id="MathJax-Span-2565"
                      style="padding-right: 0.167em; padding-left: 0.167em;"><span
                        style="display: inline-block; position: relative; width: 26.577em; height: 0px;"><span
                          style="position: absolute; clip: rect(3.692em, 1000em, 10.223em, -0.48em); top: -7.207em; left: 0em;"><span
                            style="display: inline-block; position: relative; width: 26.577em; height: 0px;"><span
                              style="position: absolute; clip: rect(1.71em, 1000em, 4.92em, -0.48em); top: -5.226em; left: 0em;"><span
                                class="mtd" id="MathJax-Span-2566"><span class="mrow" id="MathJax-Span-2567"><span
                                    class="texatom" id="MathJax-Span-2568"><span class="mrow"
                                      id="MathJax-Span-2569"><span class="msubsup" id="MathJax-Span-2570"><span
                                          style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                              class="mi" id="MathJax-Span-2571"
                                              style="font-family: STIXGeneral-Italic;">θ<span
                                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                            style="position: absolute; top: -2.159em; left: 0.493em;"><span
                                              class="texatom" id="MathJax-Span-2572"><span class="mrow"
                                                id="MathJax-Span-2573"><span class="mi" id="MathJax-Span-2574"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                        class="mo" id="MathJax-Span-2575"
                                        style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">←</span><span
                                        class="msubsup" id="MathJax-Span-2576" style="padding-left: 0.313em;"><span
                                          style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                              class="mi" id="MathJax-Span-2577"
                                              style="font-family: STIXGeneral-Italic;">θ<span
                                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                            style="position: absolute; top: -2.159em; left: 0.493em;"><span
                                              class="texatom" id="MathJax-Span-2578"><span class="mrow"
                                                id="MathJax-Span-2579"><span class="mi" id="MathJax-Span-2580"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                        class="mo" id="MathJax-Span-2581"
                                        style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span
                                        class="msubsup" id="MathJax-Span-2582" style="padding-left: 0.25em;"><span
                                          style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                              class="mi" id="MathJax-Span-2583"
                                              style="font-family: STIXGeneral-Italic;">α</span><span
                                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                            style="position: absolute; top: -2.159em; left: 0.563em;"><span
                                              class="texatom" id="MathJax-Span-2584"><span class="mrow"
                                                id="MathJax-Span-2585"><span class="mi" id="MathJax-Span-2586"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                        class="munderover" id="MathJax-Span-2587" style="padding-left: 0.188em;"><span
                                          style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span
                                              class="mo" id="MathJax-Span-2588"
                                              style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span
                                              style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span
                                            style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.472em); top: -1.159em; left: 0.113em;"><span
                                              class="texatom" id="MathJax-Span-2589"><span class="mrow"
                                                id="MathJax-Span-2590"><span class="mi" id="MathJax-Span-2591"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span
                                                  class="mo" id="MathJax-Span-2592"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span
                                                  class="mn" id="MathJax-Span-2593"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                                            style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.497em); top: -3.509em; left: 0.479em;"><span
                                              class="texatom" id="MathJax-Span-2594"><span class="mrow"
                                                id="MathJax-Span-2595"><span class="mi" id="MathJax-Span-2596"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                        class="msubsup" id="MathJax-Span-2597" style="padding-left: 0.188em;"><span
                                          style="display: inline-block; position: relative; width: 1.582em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span
                                              class="mi" id="MathJax-Span-2598"
                                              style="font-family: STIXGeneral-Regular;">∇</span><span
                                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                            style="position: absolute; top: -3.848em; left: 0.788em;"><span
                                              class="texatom" id="MathJax-Span-2599"><span class="mrow"
                                                id="MathJax-Span-2600"><span class="msubsup"
                                                  id="MathJax-Span-2601"><span
                                                    style="display: inline-block; position: relative; width: 0.719em; height: 0px;"><span
                                                      style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span
                                                        class="mi" id="MathJax-Span-2602"
                                                        style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span
                                                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span
                                                        style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                                                      style="position: absolute; top: -2.09em; left: 0.384em;"><span
                                                        class="texatom" id="MathJax-Span-2603"><span class="mrow"
                                                          id="MathJax-Span-2604"><span class="mi" id="MathJax-Span-2605"
                                                            style="font-size: 50%; font-family: STIXGeneral-Italic;">π<span
                                                              style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span
                                                        style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span
                                              style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span
                                        class="mi" id="MathJax-Span-2606"
                                        style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span
                                        class="mrow" id="MathJax-Span-2607" style="padding-left: 0.188em;"><span
                                          class="mo" id="MathJax-Span-2608" style="vertical-align: -0.201em;"><span
                                            style="font-family: STIXSizeOneSym;">(</span></span><span class="mi"
                                          id="MathJax-Span-2609" style="font-family: STIXGeneral-Italic;">π<span
                                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span
                                          class="mrow" id="MathJax-Span-2610" style="padding-left: 0.188em;"><span
                                            class="mo" id="MathJax-Span-2611" style="vertical-align: -0.201em;"><span
                                              style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                                            id="MathJax-Span-2612"><span
                                              style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span
                                                style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span
                                                  class="mi" id="MathJax-Span-2613"
                                                  style="font-family: STIXGeneral-Italic;">a</span><span
                                                  style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                                style="position: absolute; top: -2.159em; left: 0.563em;"><span
                                                  class="texatom" id="MathJax-Span-2614"><span class="mrow"
                                                    id="MathJax-Span-2615"><span class="mi" id="MathJax-Span-2616"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                                      class="mo" id="MathJax-Span-2617"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span
                                                      class="mi" id="MathJax-Span-2618"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                                  style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                            class="texatom" id="MathJax-Span-2619"><span class="mrow"
                                              id="MathJax-Span-2620"><span class="mo" id="MathJax-Span-2621"
                                                style="font-family: STIXGeneral-Regular;">|</span></span></span><span
                                            class="msubsup" id="MathJax-Span-2622"><span
                                              style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                                                style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                                  class="mi" id="MathJax-Span-2623"
                                                  style="font-family: STIXGeneral-Italic;">x<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                                  style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                                style="position: absolute; top: -2.159em; left: 0.504em;"><span
                                                  class="texatom" id="MathJax-Span-2624"><span class="mrow"
                                                    id="MathJax-Span-2625"><span class="mi" id="MathJax-Span-2626"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                                      class="mo" id="MathJax-Span-2627"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span
                                                      class="mi" id="MathJax-Span-2628"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                                  style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                            class="mo" id="MathJax-Span-2629"
                                            style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup"
                                            id="MathJax-Span-2630" style="padding-left: 0.188em;"><span
                                              style="display: inline-block; position: relative; width: 0.962em; height: 0px;"><span
                                                style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                                  class="mi" id="MathJax-Span-2631"
                                                  style="font-family: STIXGeneral-Italic;">θ<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                                  style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                                style="position: absolute; top: -2.159em; left: 0.493em;"><span
                                                  class="texatom" id="MathJax-Span-2632"><span class="mrow"
                                                    id="MathJax-Span-2633"><span class="mi" id="MathJax-Span-2634"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span
                                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span
                                                  style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                            class="mo" id="MathJax-Span-2635" style="vertical-align: -0.201em;"><span
                                              style="font-family: STIXSizeOneSym;">)</span></span></span><span
                                          class="mo" id="MathJax-Span-2636" style="vertical-align: -0.201em;"><span
                                            style="font-family: STIXSizeOneSym;">)</span></span></span><span
                                        class="mrow" id="MathJax-Span-2637" style="padding-left: 0.188em;"><span
                                          class="mo" id="MathJax-Span-2638"
                                          style="vertical-align: -0.393em; padding-left: 0.188em;"><span
                                            style="font-family: STIXSizeTwoSym;">[</span></span><span class="msubsup"
                                          id="MathJax-Span-2639"><span
                                            style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span
                                              style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span
                                                class="texatom" id="MathJax-Span-2640"><span class="mrow"
                                                  id="MathJax-Span-2641"><span class="munderover"
                                                    id="MathJax-Span-2642"><span
                                                      style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span
                                                        style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span
                                                          class="mi" id="MathJax-Span-2643"
                                                          style="font-family: STIXGeneral-Italic;">Q</span><span
                                                          style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                                        style="position: absolute; top: -4.298em; left: 0.21em;"><span
                                                          style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span
                                                          class="mo" id="MathJax-Span-2644"
                                                          style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span
                                                            style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span
                                                          style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span
                                                          style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span
                                                style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span
                                              style="position: absolute; top: -2.091em; left: 0.732em;"><span
                                                class="texatom" id="MathJax-Span-2645"><span class="mrow"
                                                  id="MathJax-Span-2646"><span class="mi" id="MathJax-Span-2647"
                                                    style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                                style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                          class="mo" id="MathJax-Span-2648"
                                          style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span
                                          class="mi" id="MathJax-Span-2649"
                                          style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span
                                            style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span
                                          class="mrow" id="MathJax-Span-2650" style="padding-left: 0.188em;"><span
                                            class="mo" id="MathJax-Span-2651" style="vertical-align: -0.201em;"><span
                                              style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup"
                                            id="MathJax-Span-2652"><span
                                              style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                                                style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                                  class="mi" id="MathJax-Span-2653"
                                                  style="font-family: STIXGeneral-Italic;">x<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                                  style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                                style="position: absolute; top: -2.159em; left: 0.504em;"><span
                                                  class="texatom" id="MathJax-Span-2654"><span class="mrow"
                                                    id="MathJax-Span-2655"><span class="mi" id="MathJax-Span-2656"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                                      class="mo" id="MathJax-Span-2657"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span
                                                      class="mi" id="MathJax-Span-2658"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                                  style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                            class="mo" id="MathJax-Span-2659"
                                            style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup"
                                            id="MathJax-Span-2660" style="padding-left: 0.188em;"><span
                                              style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span
                                                style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                                  class="mi" id="MathJax-Span-2661"
                                                  style="font-family: STIXGeneral-Italic;">θ<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                                  style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                                style="position: absolute; top: -2.159em; left: 0.493em;"><span
                                                  class="texatom" id="MathJax-Span-2662"><span class="mrow"
                                                    id="MathJax-Span-2663"><span class="mi" id="MathJax-Span-2664"
                                                      style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                                                  style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                            class="mo" id="MathJax-Span-2665" style="vertical-align: -0.201em;"><span
                                              style="font-family: STIXSizeOneSym;">)</span></span></span><span
                                          class="mo" id="MathJax-Span-2666" style="vertical-align: -0.393em;"><span
                                            style="font-family: STIXSizeTwoSym;">]</span></span></span></span></span></span></span><span
                                style="display: inline-block; width: 0px; height: 3.491em;"></span></span><span
                              style="position: absolute; clip: rect(0.753em, 1000em, 3.963em, -0.48em); top: -0.947em; left: 0em;"><span
                                class="mtd" id="MathJax-Span-2667"><span class="mrow" id="MathJax-Span-2668"><span
                                    class="texatom" id="MathJax-Span-2669"><span class="mrow"
                                      id="MathJax-Span-2670"><span class="msubsup" id="MathJax-Span-2671"><span
                                          style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                              class="mi" id="MathJax-Span-2672"
                                              style="font-family: STIXGeneral-Italic;">θ<span
                                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                            style="position: absolute; top: -2.159em; left: 0.493em;"><span
                                              class="texatom" id="MathJax-Span-2673"><span class="mrow"
                                                id="MathJax-Span-2674"><span class="mi" id="MathJax-Span-2675"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                        class="mo" id="MathJax-Span-2676"
                                        style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">←</span><span
                                        class="msubsup" id="MathJax-Span-2677" style="padding-left: 0.313em;"><span
                                          style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                              class="mi" id="MathJax-Span-2678"
                                              style="font-family: STIXGeneral-Italic;">θ<span
                                                style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                            style="position: absolute; top: -2.159em; left: 0.493em;"><span
                                              class="texatom" id="MathJax-Span-2679"><span class="mrow"
                                                id="MathJax-Span-2680"><span class="mi" id="MathJax-Span-2681"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                        class="mo" id="MathJax-Span-2682"
                                        style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span
                                        class="msubsup" id="MathJax-Span-2683" style="padding-left: 0.25em;"><span
                                          style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                              class="mi" id="MathJax-Span-2684"
                                              style="font-family: STIXGeneral-Italic;">α</span><span
                                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                            style="position: absolute; top: -2.159em; left: 0.563em;"><span
                                              class="texatom" id="MathJax-Span-2685"><span class="mrow"
                                                id="MathJax-Span-2686"><span class="mi" id="MathJax-Span-2687"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                                    style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                        class="munderover" id="MathJax-Span-2688" style="padding-left: 0.188em;"><span
                                          style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span
                                              class="mo" id="MathJax-Span-2689"
                                              style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span
                                              style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span
                                            style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.472em); top: -1.159em; left: 0.113em;"><span
                                              class="texatom" id="MathJax-Span-2690"><span class="mrow"
                                                id="MathJax-Span-2691"><span class="mi" id="MathJax-Span-2692"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span
                                                  class="mo" id="MathJax-Span-2693"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span
                                                  class="mn" id="MathJax-Span-2694"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                                            style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.497em); top: -3.509em; left: 0.479em;"><span
                                              class="texatom" id="MathJax-Span-2695"><span class="mrow"
                                                id="MathJax-Span-2696"><span class="mi" id="MathJax-Span-2697"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                        class="msubsup" id="MathJax-Span-2698" style="padding-left: 0.188em;"><span
                                          style="display: inline-block; position: relative; width: 1.638em; height: 0px;"><span
                                            style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span
                                              class="mi" id="MathJax-Span-2699"
                                              style="font-family: STIXGeneral-Regular;">∇</span><span
                                              style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                            style="position: absolute; top: -3.848em; left: 0.788em;"><span
                                              class="texatom" id="MathJax-Span-2700"><span class="mrow"
                                                id="MathJax-Span-2701"><span class="msubsup"
                                                  id="MathJax-Span-2702"><span
                                                    style="display: inline-block; position: relative; width: 0.775em; height: 0px;"><span
                                                      style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span
                                                        class="mi" id="MathJax-Span-2703"
                                                        style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span
                                                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span
                                                        style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span
                                                      style="position: absolute; top: -2.09em; left: 0.384em;"><span
                                                        class="texatom" id="MathJax-Span-2704"><span class="mrow"
                                                          id="MathJax-Span-2705"><span class="mi" id="MathJax-Span-2706"
                                                            style="font-size: 50%; font-family: STIXGeneral-Italic;">V<span
                                                              style="display: inline-block; overflow: hidden; height: 1px; width: 0.038em;"></span></span></span></span><span
                                                        style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span
                                              style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span
                                        class="msubsup" id="MathJax-Span-2707"><span
                                          style="display: inline-block; position: relative; width: 8.577em; height: 0px;"><span
                                            style="position: absolute; clip: rect(2.15em, 1000em, 4.332em, -0.317em); top: -3.491em; left: 0em;"><span
                                              class="mrow" id="MathJax-Span-2708"><span class="mo"
                                                id="MathJax-Span-2709" style="vertical-align: -0.393em;"><span
                                                  style="font-family: STIXSizeTwoSym;">[</span></span><span
                                                class="msubsup" id="MathJax-Span-2710"><span
                                                  style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span
                                                    style="position: absolute; clip: rect(2.855em, 1000em, 4.349em, -0.682em); top: -3.998em; left: 0em;"><span
                                                      class="texatom" id="MathJax-Span-2711"><span class="mrow"
                                                        id="MathJax-Span-2712"><span class="munderover"
                                                          id="MathJax-Span-2713"><span
                                                            style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span
                                                              style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span
                                                                class="mi" id="MathJax-Span-2714"
                                                                style="font-family: STIXGeneral-Italic;">Q</span><span
                                                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                                              style="position: absolute; top: -4.298em; left: 0.21em;"><span
                                                                style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span
                                                                class="mo" id="MathJax-Span-2715"
                                                                style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span
                                                                  style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span
                                                                style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span
                                                                style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span
                                                      style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span
                                                    style="position: absolute; top: -2.091em; left: 0.732em;"><span
                                                      class="texatom" id="MathJax-Span-2716"><span class="mrow"
                                                        id="MathJax-Span-2717"><span class="mi" id="MathJax-Span-2718"
                                                          style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                                      style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                                class="mo" id="MathJax-Span-2719"
                                                style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span
                                                class="mi" id="MathJax-Span-2720"
                                                style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span
                                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span
                                                class="mrow" id="MathJax-Span-2721" style="padding-left: 0.188em;"><span
                                                  class="mo" id="MathJax-Span-2722"
                                                  style="vertical-align: -0.201em;"><span
                                                    style="font-family: STIXSizeOneSym;">(</span></span><span
                                                  class="msubsup" id="MathJax-Span-2723"><span
                                                    style="display: inline-block; position: relative; width: 1.536em; height: 0px;"><span
                                                      style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span
                                                        class="mi" id="MathJax-Span-2724"
                                                        style="font-family: STIXGeneral-Italic;">x<span
                                                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span
                                                        style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                                      style="position: absolute; top: -2.159em; left: 0.504em;"><span
                                                        class="texatom" id="MathJax-Span-2725"><span class="mrow"
                                                          id="MathJax-Span-2726"><span class="mi" id="MathJax-Span-2727"
                                                            style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span
                                                              style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span
                                                            class="mo" id="MathJax-Span-2728"
                                                            style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span
                                                            class="mi" id="MathJax-Span-2729"
                                                            style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span
                                                        style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                                  class="mo" id="MathJax-Span-2730"
                                                  style="font-family: STIXGeneral-Regular;">;</span><span
                                                  class="msubsup" id="MathJax-Span-2731"
                                                  style="padding-left: 0.188em;"><span
                                                    style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span
                                                      style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                                                        class="mi" id="MathJax-Span-2732"
                                                        style="font-family: STIXGeneral-Italic;">θ<span
                                                          style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span
                                                        style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                                                      style="position: absolute; top: -2.159em; left: 0.493em;"><span
                                                        class="texatom" id="MathJax-Span-2733"><span class="mrow"
                                                          id="MathJax-Span-2734"><span class="mi" id="MathJax-Span-2735"
                                                            style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                                              style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                                                        style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                                                  class="mo" id="MathJax-Span-2736"
                                                  style="vertical-align: -0.201em;"><span
                                                    style="font-family: STIXSizeOneSym;">)</span></span></span><span
                                                class="mo" id="MathJax-Span-2737"
                                                style="vertical-align: -0.393em;"><span
                                                  style="font-family: STIXSizeTwoSym;">]</span></span></span><span
                                              style="display: inline-block; width: 0px; height: 3.491em;"></span></span><span
                                            style="position: absolute; top: -3.208em; left: 8.108em;"><span
                                              class="texatom" id="MathJax-Span-2738"><span class="mrow"
                                                id="MathJax-Span-2739"><span class="mn" id="MathJax-Span-2740"
                                                  style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span></span></span><span
                                              style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span></span></span><span
                                style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                            style="display: inline-block; width: 0px; height: 7.207em;"></span></span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 7em; vertical-align: -3.222em;"></span></span>
          </nobr>
        </span></div>
      <script type="math/tex; mode=display" id="MathJax-Element-146">
        \begin{array}{l}{\theta_{\pi} \leftarrow \theta_{\pi}+\alpha_{\pi} \sum_{i=0}^{n} \nabla_{\theta_{\pi}} \log \left(\pi\left(a_{t+i} | x_{t+i} ; \theta_{\pi}\right)\right)\left[\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right]} \\ {\theta_{V} \leftarrow \theta_{V}-\alpha_{V} \sum_{i=0}^{n} \nabla_{\theta_{V}}\left[\hat{Q}_{i}-V\left(x_{t+i} ; \theta_{V}\right)\right]^{2}}\end{array} 
      </script><br>
      where <span class="MathJax" id="MathJax-Element-147-Frame" role="textbox" aria-readonly="true" style="">
        <nobr><span class="math" id="MathJax-Span-2741" style="width: 3.703em; display: inline-block;"><span
              style="display: inline-block; position: relative; width: 3.322em; height: 0px; font-size: 111%;"><span
                style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span
                  class="mrow" id="MathJax-Span-2742"><span class="mrow" id="MathJax-Span-2743"><span class="mo"
                      id="MathJax-Span-2744" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup"
                      id="MathJax-Span-2745"><span
                        style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span
                          style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                            class="mi" id="MathJax-Span-2746" style="font-family: STIXGeneral-Italic;">α</span><span
                            style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                          style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom"
                            id="MathJax-Span-2747"><span class="mrow" id="MathJax-Span-2748"><span class="mi"
                                id="MathJax-Span-2749" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                      class="mo" id="MathJax-Span-2750" style="font-family: STIXGeneral-Regular;">,</span><span
                      class="msubsup" id="MathJax-Span-2751" style="padding-left: 0.188em;"><span
                        style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span
                          style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span
                            class="mi" id="MathJax-Span-2752" style="font-family: STIXGeneral-Italic;">α</span><span
                            style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span
                          style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom"
                            id="MathJax-Span-2753"><span class="mrow" id="MathJax-Span-2754"><span class="mi"
                                id="MathJax-Span-2755" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span
                                  style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span
                            style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span
                      class="mo" id="MathJax-Span-2756"
                      style="font-family: STIXGeneral-Regular;">)</span></span></span><span
                  style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
              style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span>
        </nobr>
      </span>
      <script type="math/tex" id="MathJax-Element-147">\left(\alpha_{\pi}, \alpha_{V}\right)</script> are learning rates
      are policy-head and value-head.<p></p>
      <h3>2.2 Network Architecture</h3>
      <p>Similar to the <a
          href="https://github.com/pytorch/examples/blob/master/reinforcement_learning/actor_critic.py">Actor-critic
          example from pytorch</a> and <a
          href="https://github.com/floodsung/a2c_cartpole_pytorch/blob/master/a2c_cartpole.py">Floodsung's repo</a>, we
        use simple and straightforward networks for both the actor function and the critic function.</p>
      <h4>2.2.1 Actor Network</h4>
      <p>The actor network consists of two fully connected layers which extract potential features from the input
        observations. To introduce non-linearity, the ReLU activations <a
          href="https://arxiv.org/abs/1803.08375">[3]</a> are used upon these two layers. Then, the output is another
        fully connected layer which summarizes into one-dimensional continuous value.</p>
      <h4>2.2.2 Critic Network</h4>
      <p>The critic network shares the similar architecture with the actor network with the fully connected layers and
        the ReLU activations. However, depending on the environment, discrete or continuous action space, the final
        output is distinct. For discrete action space, the <span class="MathJax" id="MathJax-Element-148-Frame"
          role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2757" style="width: 1.516em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 1.351em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.488em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2758"><span class="mi" id="MathJax-Span-2759"
                      style="font-family: STIXGeneral-Regular;">log</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.125em; vertical-align: -0.304em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-148">\log</script> Softmax is used to compute the distribution of
        the available discrete actions. For continuous action space, we instead output a mean and a standard deviation
        for the univariate Gaussian distribution, which we later use to sample continuous actions.
      </p>
      <h2>3. Experiments</h2>
      <p>All our code are available on Github.</p>
      <blockquote>
        <p><a href="https://github.com/vincentwen1995/rl-reprod">Reinforcement Learning Reproducibility Lab</a></p>
      </blockquote>
      <h3>3.1 Environments</h3>
      <p>For this project, our main goal is to compare the performance of the N-step bootstrapping variation of A2C with
        its Monte-Carlo and 1-step variations in a straightforward manner. Therefore, we do not seek to deliver an
        ultimate agent that can solve some complicated fancy games or park your car.</p>
      <p>The experiments are designed with classical control problems, i.e. InvertedPendulum, CartPole, Acrobot,
        MountainCar etc. For the sake of convenience in terms of implementation, we use the off-the-shelf environments
        provided by <a href="https://gym.openai.com">OpenAI's Gym library</a>. Under the category <span class="MathJax"
          id="MathJax-Element-149-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2760" style="width: 8.016em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 7.207em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.721em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2761"><span class="texatom" id="MathJax-Span-2762"><span class="mrow"
                        id="MathJax-Span-2763"><span class="mtext" id="MathJax-Span-2764"
                          style="font-family: STIXGeneral-Italic;">Classical Control</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.082em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-149">\textit{Classical Control}</script>, we picked out two discrete
        environments: <span class="MathJax" id="MathJax-Element-150-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2765" style="width: 5.828em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 5.236em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.674em, 1000em, 2.722em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2766"><span class="texatom" id="MathJax-Span-2767"><span class="mrow"
                        id="MathJax-Span-2768"><span class="mtext" id="MathJax-Span-2769"
                          style="font-family: STIXGeneral; font-weight: bold;">CartPole-v0</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.913em; vertical-align: -0.084em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-150">\textbf{CartPole-v0}</script> and <span class="MathJax"
          id="MathJax-Element-151-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2770" style="width: 5.453em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 4.899em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.675em, 1000em, 2.717em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2771"><span class="texatom" id="MathJax-Span-2772"><span class="mrow"
                        id="MathJax-Span-2773"><span class="mtext" id="MathJax-Span-2774"
                          style="font-family: STIXGeneral; font-weight: bold;">Acrobot-v1</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.906em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-151">\textbf{Acrobot-v1}</script>.
      </p>
      <p>The <span class="MathJax" id="MathJax-Element-150-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2765" style="width: 5.828em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 5.236em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.674em, 1000em, 2.722em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2766"><span class="texatom" id="MathJax-Span-2767"><span class="mrow"
                        id="MathJax-Span-2768"><span class="mtext" id="MathJax-Span-2769"
                          style="font-family: STIXGeneral; font-weight: bold;">CartPole-v0</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.913em; vertical-align: -0.084em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-150">\textbf{CartPole-v0}</script> environment contains a pole
        attached by a an un-actuated joint to a cart in a 2D plane. The cart moves left/right along a frictionless
        track. The goal is to balance the poll staying upright by indirectly influencing the velocity of the cart. There
        are 4 continuous observations of this environment, consisting of the <span class="MathJax"
          id="MathJax-Element-152-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2775" style="width: 6.078em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 5.462em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2776"><span class="texatom" id="MathJax-Span-2777"><span class="mrow"
                        id="MathJax-Span-2778"><span class="mtext" id="MathJax-Span-2779"
                          style="font-family: STIXGeneral-Italic;">Cart Position</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.884em; vertical-align: -0.082em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-152">\textit{Cart Position}</script>, <span class="MathJax"
          id="MathJax-Element-153-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2780" style="width: 6.016em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 5.405em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.909em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2781"><span class="texatom" id="MathJax-Span-2782"><span class="mrow"
                        id="MathJax-Span-2783"><span class="mtext" id="MathJax-Span-2784"
                          style="font-family: STIXGeneral-Italic;">Cart Velocity</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.112em; vertical-align: -0.291em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-153">\textit{Cart Velocity}</script>, <span class="MathJax"
          id="MathJax-Element-154-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2785" style="width: 4.891em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 4.392em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.909em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2786"><span class="texatom" id="MathJax-Span-2787"><span class="mrow"
                        id="MathJax-Span-2788"><span class="mtext" id="MathJax-Span-2789"
                          style="font-family: STIXGeneral-Italic;">Pole Angle</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.112em; vertical-align: -0.291em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-154">\textit{Pole Angle}</script> and <span class="MathJax"
          id="MathJax-Element-155-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2790" style="width: 9.016em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 8.108em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.909em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2791"><span class="texatom" id="MathJax-Span-2792"><span class="mrow"
                        id="MathJax-Span-2793"><span class="mtext" id="MathJax-Span-2794"
                          style="font-family: STIXGeneral-Italic;">Pole Velocity At Tip</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.112em; vertical-align: -0.291em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-155">\textit{Pole Velocity At Tip}</script> within their
        corresponding range. The available actions consist of two discrete actions <span class="MathJax"
          id="MathJax-Element-156-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2795" style="width: 4.328em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 3.885em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.91em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2796"><span class="texatom" id="MathJax-Span-2797"><span class="mrow"
                        id="MathJax-Span-2798"><span class="mtext" id="MathJax-Span-2799"
                          style="font-family: STIXGeneral-Italic;">Push Left</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.113em; vertical-align: -0.292em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-156">\textit{Push Left}</script> and <span class="MathJax"
          id="MathJax-Element-157-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2800" style="width: 5.016em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 4.505em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.909em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2801"><span class="texatom" id="MathJax-Span-2802"><span class="mrow"
                        id="MathJax-Span-2803"><span class="mtext" id="MathJax-Span-2804"
                          style="font-family: STIXGeneral-Italic;">Push Right</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.112em; vertical-align: -0.291em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-157">\textit{Push Right}</script>, which increases the <span
          class="MathJax" id="MathJax-Element-153-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2780" style="width: 6.016em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 5.405em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.909em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2781"><span class="texatom" id="MathJax-Span-2782"><span class="mrow"
                        id="MathJax-Span-2783"><span class="mtext" id="MathJax-Span-2784"
                          style="font-family: STIXGeneral-Italic;">Cart Velocity</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.112em; vertical-align: -0.291em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-153">\textit{Cart Velocity}</script> by an unknown amount in the
        corresponding direction. At starting state, all the observations are initialized with a small uniform random
        value. The termination of each episode is defined by the pole angle's or the cart position's exceeding a certain
        threshold, or when the episode length exceeds 200 steps. The reward is 1 for every step taken in each episode,
        indicating the durability of the stabilization by the agent. You can see it in the Figure 2 (From "<a
          href="https://dzone.com/articles/using-bayesian-optimization-for-reinforcement-lear">Using Bayesian
          Optimization for Reinforcement Learning</a>").
      </p>
      <div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191018234318832.gif" width="300"
          height="300" alt="N-steps" align="center"></div>
      <center>Figure2: Cartpole.</center>
      <p>The <span class="MathJax" id="MathJax-Element-158-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2805" style="width: 6.453em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 5.8em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.677em, 1000em, 2.717em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2806"><span class="texatom" id="MathJax-Span-2807"><span class="mrow"
                        id="MathJax-Span-2808"><span class="mtext" id="MathJax-Span-2809"
                          style="font-family: STIXGeneral; font-weight: bold;">Pendulum-v0</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.904em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-158">\textbf{Pendulum-v0}</script> environment contains a pendulum,
        or in other words, a link connected to an actuated joint in a 2D plane. The pendulum can spin frictionlessly.
        The goal is to keep the pendulum upright by applying a continuous torque on the joint. There are 3 continuous
        observations of this environment, consisting of the <span class="MathJax" id="MathJax-Element-159-Frame"
          role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2810" style="width: 1.516em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 1.351em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.482em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2811"><span class="mi" id="MathJax-Span-2812"
                      style="font-family: STIXGeneral-Regular;">cos</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.647em; vertical-align: -0.074em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-159">\cos</script> and <span class="MathJax"
          id="MathJax-Element-160-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2813" style="width: 1.391em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 1.239em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.713em, -0.456em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2814"><span class="mi" id="MathJax-Span-2815"
                      style="font-family: STIXGeneral-Regular;">sin</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.894em; vertical-align: -0.074em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-160">\sin</script> values of the <span class="MathJax"
          id="MathJax-Element-161-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2816" style="width: 7.391em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 6.644em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.909em, -0.507em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2817"><span class="texatom" id="MathJax-Span-2818"><span class="mrow"
                        id="MathJax-Span-2819"><span class="mtext" id="MathJax-Span-2820"
                          style="font-family: STIXGeneral-Italic;">Pendulum Angle</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.112em; vertical-align: -0.291em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-161">\textit{Pendulum Angle}</script> respectively and the <span
          class="MathJax" id="MathJax-Element-162-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2821" style="width: 7.641em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 6.869em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.909em, -0.558em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2822"><span class="texatom" id="MathJax-Span-2823"><span class="mrow"
                        id="MathJax-Span-2824"><span class="mtext" id="MathJax-Span-2825"
                          style="font-family: STIXGeneral-Italic;">Angular Velocity</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.112em; vertical-align: -0.291em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-162">\textit{Angular Velocity}</script> of the pendulum. The
        available action is a continuous action <span class="MathJax" id="MathJax-Element-163-Frame" role="textbox"
          aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2826" style="width: 6.078em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 5.462em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.682em, 1000em, 2.912em, -0.558em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2827"><span class="texatom" id="MathJax-Span-2828"><span class="mrow"
                        id="MathJax-Span-2829"><span class="mtext" id="MathJax-Span-2830"
                          style="font-family: STIXGeneral-Italic;">Apply Torque</span></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.115em; vertical-align: -0.294em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-163">\textit{Apply Torque}</script>. At starting state, the pendulum
        is initiated at a random angle and a random angular velocity. The environment is terminated when the episode
        length exceeds 200 steps. The reward is computed according to a function of the angle, angular velocity and the
        torque, which ranges from <span class="MathJax" id="MathJax-Element-164-Frame" role="textbox"
          aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2831" style="width: 1.953em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 1.745em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.681em, 1000em, 2.717em, -0.443em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2832"><span class="mo" id="MathJax-Span-2833"
                      style="font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2834"
                      style="font-family: STIXGeneral-Regular;">16</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.9em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-164">-16</script> to <span class="MathJax"
          id="MathJax-Element-165-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2835" style="width: 0.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.483em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2836"><span class="mn" id="MathJax-Span-2837"
                      style="font-family: STIXGeneral-Regular;">0</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-165">0</script>, so the goal can be explained as to remain at zero
        angle, with the least angular velocity and the least torque, indicating the speed and the quality of the
        stabilization by the agent. You can see it in Figure 3 (From "<a
          href="https://towardsdatascience.com/solving-reinforcement-learning-classic-control-problems-openaigym-1b50413265dd">Solving
          Reinforcement Learning Classic Control Problems | OpenAIGym</a>").
      </p>
      <div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191018234847731.gif" width="300"
          height="300" alt="N-steps" align="center"></div>
      <center>Figure3: Pendulum</center>
      <h2>3.2 Settings</h2>
      <p>The hyperparameter settings are trivial for the actor and critic networks. In the aforementioned fully
        connected layers, we use a hidden size of 64 nodes, which we found empirically. Furthermore, the discount rate
        <span class="MathJax" id="MathJax-Element-166-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2838" style="width: 0.516em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2839"><span class="mi" id="MathJax-Span-2840"
                      style="font-family: STIXGeneral-Italic;">γ<span
                        style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.837em; vertical-align: -0.291em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-166">\gamma</script> is set to 0.99.
      </p>
      <p>In order to evaluate how different <span class="MathJax" id="MathJax-Element-135-Frame" role="textbox"
          aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2196" style="width: 0.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2197"><span class="mi" id="MathJax-Span-2198"
                      style="font-family: STIXGeneral-Italic;">n</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-135">n</script> will affect the performances, we need to conduct
        experiments and investigate the model behaviors in different learning stages.
      </p>
      <p>To make the comparison objective and accurate, instead of fixing the number of training episodes, we fix the
        total number of <span class="MathJax" id="MathJax-Element-167-Frame" role="textbox" aria-readonly="true"
          style="">
          <nobr><span class="math" id="MathJax-Span-2841" style="width: 2.828em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 2.534em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2842"><span class="mn" id="MathJax-Span-2843"
                      style="font-family: STIXGeneral-Regular;">10000</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-167">10000</script> training steps. More specific, for training,
        each agent will interact and learn in the environments for <span class="MathJax" id="MathJax-Element-168-Frame"
          role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2844" style="width: 1.703em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2845"><span class="mn" id="MathJax-Span-2846"
                      style="font-family: STIXGeneral-Regular;">100</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-168">100</script> steps according to their updating schemes strictly
        (N-steps, TD or MC).
      </p>
      <p>For example, if in a training cycle, the MC agent starts in time-step 14 and after 86 steps (totally 100 steps)
        the episode still continues, the MC agent will not receive any updates. Then, for evaluation, we run the agent
        in the exact environments as in training for 50 episodes and store the total rewards per episode. With this
        data, the learning behavior and model performance of each agent can be represented and compared scientifically
        in terms of mean and standard deviation per evaluation step and, furthermore, the mean and variance could be
        used to show the effectiveness and stability of learning accordingly.</p>
      <p>To fully cover MC, TD and N-step bootstrapping, we chose and tested 6 different <span class="MathJax"
          id="MathJax-Element-135-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2196" style="width: 0.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2197"><span class="mi" id="MathJax-Span-2198"
                      style="font-family: STIXGeneral-Italic;">n</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-135">n</script> given the different termination conditions of two
        environments, which ranges from 1-step to max-step (or equivalently Monte Carlo). Finally, to decrease the
        effect of randomness, three different random seeds are tested and the experiment settings are shown in Table 1.
      </p>
      <ul>
        <li>Training: each agent will gain experience in the environment for every <span class="MathJax"
            id="MathJax-Element-168-Frame" role="textbox" aria-readonly="true" style="">
            <nobr><span class="math" id="MathJax-Span-2844" style="width: 1.703em; display: inline-block;"><span
                  style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 111%;"><span
                    style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span
                      class="mrow" id="MathJax-Span-2845"><span class="mn" id="MathJax-Span-2846"
                        style="font-family: STIXGeneral-Regular;">100</span></span><span
                      style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                  style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
            </nobr>
          </span>
          <script type="math/tex" id="MathJax-Element-168">100</script> steps and learn (or update their networks)
          according to their schemes.
        </li>
        <li>Evaluation: after very <span class="MathJax" id="MathJax-Element-168-Frame" role="textbox"
            aria-readonly="true" style="">
            <nobr><span class="math" id="MathJax-Span-2844" style="width: 1.703em; display: inline-block;"><span
                  style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 111%;"><span
                    style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span
                      class="mrow" id="MathJax-Span-2845"><span class="mn" id="MathJax-Span-2846"
                        style="font-family: STIXGeneral-Regular;">100</span></span><span
                      style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                  style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
            </nobr>
          </span>
          <script type="math/tex" id="MathJax-Element-168">100</script> training steps, each agents will be tested in
          the same environments and play for <span class="MathJax" id="MathJax-Element-169-Frame" role="textbox"
            aria-readonly="true" style="">
            <nobr><span class="math" id="MathJax-Span-2847" style="width: 1.141em; display: inline-block;"><span
                  style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span
                    style="position: absolute; clip: rect(1.677em, 1000em, 2.717em, -0.476em); top: -2.534em; left: 0em;"><span
                      class="mrow" id="MathJax-Span-2848"><span class="mn" id="MathJax-Span-2849"
                        style="font-family: STIXGeneral-Regular;">50</span></span><span
                      style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                  style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.904em; vertical-align: -0.078em;"></span></span>
            </nobr>
          </span>
          <script type="math/tex" id="MathJax-Element-169">50</script> episodes. There will be no learning in this stage
          and the rewards will be stored.
        </li>
      </ul>
      <center>Table1: Hyperparameter settings of the experiments.</center>
      <table>
        <thead>
          <tr>
            <th>Environment</th>
            <th>Train Steps</th>
            <th>Eval Interval</th>
            <th>Eval steps</th>
            <th>Random Seeds</th>
            <th>Steps Roll-out</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>CartPole-v0</td>
            <td>10000</td>
            <td>100</td>
            <td>50</td>
            <td>[42, 36, 15]</td>
            <td>[1, 10, 40, 80, 150, 200]</td>
          </tr>
          <tr>
            <td>Pendulum-v0</td>
            <td>10000</td>
            <td>100</td>
            <td>50</td>
            <td>[42, 36, 15]</td>
            <td>[1, 10, 40, 80, 150, 200]</td>
          </tr>
        </tbody>
      </table>
      <h2>4. Results</h2>
      <p>The results are shown in Figure 4 - Figure 7, where for better visualization and distinction, only two N-step
        variations are selected.</p>
      <h3>4.1 CartPole</h3>
      <p>As shown in Figure 4, generally, except for 1-step TD, all the variations converge finally to the expected
        average return of <span class="MathJax" id="MathJax-Element-170-Frame" role="textbox" aria-readonly="true"
          style="">
          <nobr><span class="math" id="MathJax-Span-2850" style="width: 1.703em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.478em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2851"><span class="mn" id="MathJax-Span-2852"
                      style="font-family: STIXGeneral-Regular;">200</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-170">200</script>. The 1-step TD fails to learn and achieve an
        average reward of around 10, which is possibly because of the complexity of the environment, where the bias in
        1-step learning is too large and the learning diverges. It can also be observed that, with increasing <span
          class="MathJax" id="MathJax-Element-135-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2196" style="width: 0.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2197"><span class="mi" id="MathJax-Span-2198"
                      style="font-family: STIXGeneral-Italic;">n</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-135">n</script>, the variance increases, which also aligns with the
        fact that for Monte-Carlo methods compared with 1-step TD methods, the bias is low but the variance is high, and
        vice versa.
      </p>
      <div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191019000604764.png" width="600"
          height="350" alt="N-steps" align="center"></div>
      <center>Figure 4: Results for CartPole-v0.</center>
      <p>Furthermore, observing the truncated results for 3000 steps in Figure 5, we can see that because of the
        relatively higher biases for smaller <span class="MathJax" id="MathJax-Element-135-Frame" role="textbox"
          aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2196" style="width: 0.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2197"><span class="mi" id="MathJax-Span-2198"
                      style="font-family: STIXGeneral-Italic;">n</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-135">n</script>'s (40), the convergences are significantly slower.
        While for <span class="MathJax" id="MathJax-Element-171-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2853" style="width: 3.766em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 3.378em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.677em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2854"><span class="mi" id="MathJax-Span-2855"
                      style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2856"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn"
                      id="MathJax-Span-2857"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">150</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.904em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-171">n=150</script> and <span class="MathJax"
          id="MathJax-Element-172-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2858" style="width: 3.766em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 3.378em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2859"><span class="mi" id="MathJax-Span-2860"
                      style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2861"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn"
                      id="MathJax-Span-2862"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">200</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-172">n=200</script>, the convergence is fast.
      </p>
      <div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191019001419372.png" width="600"
          height="350" alt="N-steps" align="center"></div>
      <center>Figure 5: Results for CartPole-v0.</center>
      <p>To summarize, by taking into consideration both the convergence stability and the convergence speed, a
        relatively good performance is observed for <span class="MathJax" id="MathJax-Element-173-Frame" role="textbox"
          aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2863" style="width: 3.203em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2864"><span class="mi" id="MathJax-Span-2865"
                      style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2866"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn"
                      id="MathJax-Span-2867"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">40</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-173">n=40</script>.
      </p>
      <h3>4.2 Pendulum</h3>
      <p>As shown in Figure 6, in general, the performance is not as good as the CartPole case, and convergence is
        hardly achieved. For <span class="MathJax" id="MathJax-Element-173-Frame" role="textbox" aria-readonly="true"
          style="">
          <nobr><span class="math" id="MathJax-Span-2863" style="width: 3.203em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2864"><span class="mi" id="MathJax-Span-2865"
                      style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2866"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn"
                      id="MathJax-Span-2867"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">40</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-173">n=40</script>, it is obvious that the learning curve tends to
        increase and converge, but for the other curves, given the high variance, no similar conclusions can be made.
        Nonetheless, the pattern with bias and variance trade-off w.r.t. <span class="MathJax"
          id="MathJax-Element-135-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2196" style="width: 0.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2197"><span class="mi" id="MathJax-Span-2198"
                      style="font-family: STIXGeneral-Italic;">n</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-135">n</script> can still be observed, as the standard deviations
        for smaller <span class="MathJax" id="MathJax-Element-135-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2196" style="width: 0.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2197"><span class="mi" id="MathJax-Span-2198"
                      style="font-family: STIXGeneral-Italic;">n</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-135">n</script>'s (1, 40) are relatively higher than those for
        larger <span class="MathJax" id="MathJax-Element-135-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2196" style="width: 0.578em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2197"><span class="mi" id="MathJax-Span-2198"
                      style="font-family: STIXGeneral-Italic;">n</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-135">n</script>'s (150, 200).
      </p>
      <div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191019001710754.png" width="600"
          height="350" alt="N-steps" align="center"></div>
      <center>Figure 6: Results for Pendulum-v0.</center>
      <p>On the other hand, by observing the truncated results in Figure 7, it can be seen that for <span
          class="MathJax" id="MathJax-Element-173-Frame" role="textbox" aria-readonly="true" style="">
          <nobr><span class="math" id="MathJax-Span-2863" style="width: 3.203em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2864"><span class="mi" id="MathJax-Span-2865"
                      style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2866"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn"
                      id="MathJax-Span-2867"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">40</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-173">n=40</script>, there tends to be a faster convergence compared
        to the others.
      </p>
      <div align="center"><img title="N-step" src="https://img-blog.csdnimg.cn/20191019001805732.png" width="600"
          height="350" alt="N-steps" align="center"></div>
      <center>Figure 7: Results for Pendulum-v0.</center>
      <p>To summarize, <span class="MathJax" id="MathJax-Element-173-Frame" role="textbox" aria-readonly="true"
          style="">
          <nobr><span class="math" id="MathJax-Span-2863" style="width: 3.203em; display: inline-block;"><span
                style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span
                  style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.493em); top: -2.534em; left: 0em;"><span
                    class="mrow" id="MathJax-Span-2864"><span class="mi" id="MathJax-Span-2865"
                      style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2866"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn"
                      id="MathJax-Span-2867"
                      style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">40</span></span><span
                    style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span
                style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span>
          </nobr>
        </span>
        <script type="math/tex" id="MathJax-Element-173">n=40</script> would be the preferable choice for this
        environment.
      </p>
      <h2>Conclusion</h2>
      <p>In this project, we investigate how different n for N-step bootstrapping could affect the learning behaviors of
        the A2C agent. We show that when using n=1, i.e., the TD method, the A2C agents are seldom capable of learning
        for both the CartPole and Pendulum environments.</p>
      <p>While using MC, for the CartPole environment, the A2C agents are capable of learning with faster convergence
        but show a more volatile and unstable behaviors. However, for the Pendulum environment, convergence is not
        observed and future investigations need to be done. After the experiments, in general, we show that N-step
        bootstrapping achieves a relatively better performance in terms of convergence stability and the convergence
        speed compared to 1-step TD and MC by compensating between bias and variance. Hence, choosing an appropriate
        intermediate n could be vital for different application or problems in Reinforcement Learning.</p>
      <h2>References</h2>
      <blockquote>
        <p>[1] Sutton, Richard S., and Andrew G. Barto. Reinforcement learning: An introduction. MIT press, 2018.<br>
          [2] Schulman, John, et al. "High-dimensional continuous control using generalized advantage estimation." arXiv
          preprint arXiv:1506.02438 (2015).<br>
          [3] Agarap, Abien Fred. "Deep learning using rectified linear units (relu)." arXiv preprint arXiv:1803.08375
          (2018).</p>
      </blockquote>
    </div>
  </div>
  <script>
    document.body.onkeyup = function (e) {}
  </script>
</body>

</html>